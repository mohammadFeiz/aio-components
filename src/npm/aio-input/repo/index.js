var __awaiter=this&&this.__awaiter||function(e,t,n,i){function o(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function a(e){try{s(i.next(e))}catch(t){r(t)}}function l(e){try{s(i.throw(e))}catch(t){r(t)}}function s(e){e.done?n(e.value):o(e.value).then(a,l)}s((i=i.apply(e,t||[])).next())})};import{createElement as _createElement}from"react";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from"react/jsx-runtime";import{createRef,useContext,createContext,useState,useEffect,useRef,Fragment,isValidElement}from"react";import usePopup from"aio-popup";import*as UT from"aio-utils";import AIODate from"aio-date";import{Indent,GetSvg}from"aio-component-utils";import $ from"jquery";import"./index.css";import{EventEmitter}from"events";let AICTX=createContext({});class AioInputDefaultsClass{constructor(){this.defaults={},this.eventEmitter=new EventEmitter}set(e){this.defaults=Object.assign(Object.assign({},this.defaults),e),this.eventEmitter.emit("update")}get(){return this.defaults}subscribe(e){return this.eventEmitter.on("update",e),()=>this.eventEmitter.off("update",e)}}export const AIOInputDefaults=new AioInputDefaultsClass;let AIOInput=e=>{let[t,n]=useState(AIOInputDefaults.get());useEffect(()=>{let e=AIOInputDefaults.subscribe(()=>{n(AIOInputDefaults.get())});return()=>{e()}},[]);let i=e.type,o=e.round,r=e.value;if("text"===i?"string"!=typeof r&&(r=""):"number"===i&&"number"!=typeof r&&(r=void 0),"spinner"===i)i="range",o&&"number"==typeof o||(o=1);else if("slider"===i)i="range",o=0;else if("range"===i)return null;let a=Object.assign(Object.assign(Object.assign({},t),e),{type:i,round:o,value:r});return"text"===i&&a.getOptions?_jsx(SuggestionInput,Object.assign({},a)):_jsx(AIOINPUT,Object.assign({},a))};export default AIOInput;let SuggestionInput=e=>{let{getOptions:t,option:n={},onChange:i}=e,[o,r]=useState([]),[a,l]=useState("");function s(e){return __awaiter(this,void 0,void 0,function*(){if(l(e),!e){r([]);return}let n=t?yield t(e):[];r(n)})}return _jsx(AIOInput,Object.assign({},e,{value:a,options:o,option:Object.assign(Object.assign({},n),{onClick(e,t){let o=GetOptionProps({optionProp:n,key:"text",optionDetails:t,optionOrg:e});s(o),i&&i(o,e)}}),getOptions:void 0,onChange(e){s(e),i&&i(e)}}))};function AIOINPUT(e){let[t]=useState(getTypes(e)),[n]=useState(new AIODate),{type:i,value:o,onChange:r,attrs:a={},rtl:l}=e=getDefaultProps(e,t),[s]=useState(createRef()),[u]=useState("aiobutton"+Math.round(1e7*Math.random())),d=usePopup({rtl:e.rtl}),[c,p]=useState(!1);function g(e){p(void 0===e?!c:e)}let[f]=useState(new UT.DragClass({callback(t,n){if("function"==typeof e.onSwap){let{fromIndex:i}=t,{options:o,toIndex:r}=n,a=f.reOrder(o,i,r);e.onSwap(a,o[i],o[r])}}}));function h(n){let o="aio-input-popover";o+=` aio-input-popover-${l?"rtl":"ltr"}`,t.hasOption&&(o+=" aio-input-dropdown"),"time"===e.type&&(o+=" aio-input-time-popover");let r=e.popover||{},a=null;return a=r.body?r.body:"date"===i?_jsx(Calendar,{onClose:d.removeModal}):"time"===i?_jsx(TimePopover,{onClose:d.removeModal}):_jsx(Options,{}),Object.assign(Object.assign({},e.popover||{}),{position:r.position||"popover",fitHorizontal:-1!==["text","number","textarea"].indexOf(i)||"select"===i&&!!e.multiple||!!r.fitHorizontal,onClose:()=>m(),body:a,getTarget:()=>$(n.current),setAttrs(e){let t=(r.setAttrs||(()=>({})))(e);return"modal"===e?UT.AddToAttrs(t,{className:o}):t}})}function m(){d.removeModal(),setTimeout(()=>$(s.current).focus(),0)}function v(n,l){if("checkbox"===i)r&&r(!o,n);else if(t.isDropdown){if(d.getModals().length)return;d.addModal(h(l))}else"function"==typeof e.onClick?e.onClick(n):a.onClick&&a.onClick()}function y(n){let{attrs:a={},onClick:l,close:s}=n;if(l)l(n.details);else if(a.onClick)a.onClick(n);else if(r){if(t.isInput);else if("tree"===i);else if("file"===i);else if(t.isMultiple){let{multiple:u}=e,d;for(d=-1===o.indexOf(n.value)?o.concat(n.value):o.filter(e=>e!==n.value);"number"==typeof u&&d.length>u;)d=d.slice(1,d.length);r(d,n.details)}else n.value!==e.value?r(n.value,n.details):!0===e.deSelect?r(void 0,n.details):"function"==typeof e.deSelect&&e.deSelect()}s&&m()}function _(){let n=[];if("date"===i){if(!e.multiple)return{optionsList:[],optionsDic:{}};n=[...e.value]}else n="function"==typeof e.options?e.options():e.options?e.options:[];return GetOptions({rootProps:e,types:t,options:n,optionProp:e.option||{}})}function x(){return{options:_(),popup:d,rootProps:Object.assign(Object.assign({},e),{value:o}),datauniqid:u,touch:"ontouchstart"in document.documentElement,DragOptions:f,click:v,optionClick:y,types:t,showPassword:c,setShowPassword:g,DATE:n}}function b(){let{round:t,vertical:n}=e;return t?"aio-input-range-round":n?"aio-input-range-vertical":"aio-input-range-horizontal"}let C={spinner:()=>null,slider:()=>null,acardion:()=>_jsx(Acardion,{}),tree:()=>_jsx(Tree,{}),tags:()=>_jsx(Layout,{properties:{text:_jsx(Tags,{})}}),list:()=>_jsx(List,{}),file:()=>_jsx(File,{}),select:()=>_jsx(Select,{}),table:()=>_jsx(Table,{}),checkbox:()=>_jsx(Layout,{}),button:()=>_jsx(Layout,{}),range:()=>_jsx(Layout,{properties:{text:_jsx(Range,{}),className:b()}}),radio:()=>_jsx(Layout,{properties:{text:_jsx(Options,{})}}),tabs:()=>_jsx(Layout,{properties:{text:_jsx(Options,{})}}),buttons:()=>_jsx(Layout,{properties:{text:_jsx(Options,{})}}),date:()=>_jsx(DateInput,{}),time:()=>_jsx(Layout,{properties:{text:getTimeText(e)}}),image:()=>_jsx(Layout,{properties:{text:_jsx(Image,{})}}),text:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}}),password:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}}),textarea:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}}),number:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}}),color:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}})};return i&&C[i]?_jsxs(AICTX.Provider,{value:x(),children:[C[i](),d.render()]},u):null}function TimePopover(e){let{DATE:t,rootProps:n}=useContext(AICTX),{jalali:i,onChange:o,size:r=12}=n,{onClose:a}=e,[l,s]=useState(getTimeByUnit(n)),u=useRef(l.year?l.year-10:void 0),d=useRef(l.year?l.year+10:void 0),c=e=>s(Object.assign(Object.assign({},l),e));function p(e){return i?({year:"سال",month:"ماه",day:"روز",hour:"ساعت",minute:"دقیقه",second:"ثانیه",Submit:"ثبت",Now:"اکنون"})[e]:e}function g(e){var i,o,r;let{year:a,month:s,day:p}=l,g=u.current,f=d.current;if("year"===e&&g&&f)return UT.GetArray(f-g+1,e=>({text:e+g,value:e+g}),null===(i=n.timeStep)||void 0===i?void 0:i.year);if("day"===e&&p){let h=a&&s?t.getMonthDaysLength([a,s]):31;return p>h&&c({day:1}),UT.GetArray(h,e=>({text:e+1,value:e+1}),null===(o=n.timeStep)||void 0===o?void 0:o.day)}return"month"===e?UT.GetArray(12,e=>({text:e+1,value:e+1}),null===(r=n.timeStep)||void 0===r?void 0:r.month):UT.GetArray("hour"===e?24:60,e=>({text:e,value:e}),n.timeStep?n.timeStep[e]:void 0)}function f(e){if("number"!=typeof l[e])return null;let t=g(e),n={type:"list",value:l[e],options:t,size:2.5*r,onChange:t=>c({[e]:t})};return _jsxs("div",{className:"aio-input-time-popover-item",children:[_jsx("div",{className:"aio-input-time-popover-item-title",children:p(e)}),_jsx(AIOInput,Object.assign({},n)),_jsx("div",{className:"aio-input-time-popover-highlight"})]})}function h(e){return e}function m(){o&&o(h(l)),a()}function v(){s(getTimeByUnit(n,!0))}return _jsxs("div",{className:"aio-input-time-popover-content aio-input-time-theme-color aio-input-time-theme-bg",style:{fontSize:r},children:[_jsxs("div",{className:"aio-input-time-popover-body",children:[f("year")," ",f("month")," ",f("day")," ",f("hour")," ",f("minute")," ",f("second")]}),_jsxs("div",{className:"aio-input-time-popover-footer",children:[_jsx("button",{onClick:m,children:p("Submit")}),!1!==n.now&&_jsx("button",{onClick:()=>v(),children:p("Now")})]})]})}function Image(){let{rootProps:e,popup:t}=useContext(AICTX),{value:n,attrs:i,onChange:o,disabled:r,placeholder:a,preview:l,deSelect:s,imageAttrs:u={}}=e,[d,c]=useState(),p=createRef();function g(e,t){try{let n=new FileReader;n.onload=function(){d!==n.result&&(c(n.result),t&&t(n.result))},n.readAsDataURL(e)}catch(i){}}function f(e){e.stopPropagation(),e.preventDefault(),h()}function h(){t.addModal({position:"center",header:{title:"",onClose:()=>t.removeModal()},body:_jsx("div",{className:"aio-input-image-preview-popup",children:_jsx("img",{src:$(p.current).attr("src")})})})}useEffect(()=>{n&&null!==n?"object"==typeof n?g(n):"string"==typeof n&&d!==n&&c(n):d!==n&&c("")});let m=d?_jsxs(_Fragment,{children:[_jsx("img",Object.assign({ref:p,src:d,style:{objectFit:"contain",cursor:o?void 0:"default"},onClick:o?void 0:f,height:"100%"},u)),!!s&&_jsx("div",{onClick(e){e.stopPropagation(),e.preventDefault(),"function"==typeof s?s():o&&o("")},className:"aio-input-image-remove",children:I("mdiClose",1)}),l&&!!o&&_jsx("div",{onClick:e=>f(e),className:"aio-input-image-preview",children:I("mdiImage",1)}),t.render()]}):_jsx("span",Object.assign({},i,{className:"aio-input-image-placeholder",children:a||"placeholder"}));if(!o)return m;let v={disabled:r,justify:!0,text:m,attrs:{style:{width:"100%",height:"100%",padding:0}},onChange:e=>g(e,e=>{o&&o(e)})};return _jsx(AIFile,Object.assign({},v))}function File(){return _jsxs("div",{className:"aio-input-file-container",children:[_jsx(Layout,{}),_jsx(FileItems,{})]})}function InputFile(){let{rootProps:e,types:t}=useContext(AICTX),{value:n=[],onChange:i=()=>{},disabled:o,multiple:r,inputAttrs:a}=e;function l(e){let o=e.target.files,a;if(t.isMultiple){let l=(a=[...n]).map(({name:e})=>e);for(let s=0;s<o.length;s++){let u=o[s];-1===l.indexOf(u.name)&&a.push({name:u.name,size:u.size,file:u})}if("number"==typeof r)for(;a.length>r;)a=a.slice(1,a.length)}else a=o.length?o[0]:void 0;i(a)}let s;return _jsx("input",Object.assign({},Object.assign({disabled:!0===o,type:"file",style:{display:"none"},multiple:t.isMultiple,onChange:e=>l(e)},a)))}function FileItems(){let{rootProps:e}=useContext(AICTX),{value:t,rtl:n}=e,i=[];if(Array.isArray(t))i=t;else{if(!t)return null;i=[t]}if(!i.length)return null;let o=i.map((e,t)=>_jsx(FileItem,{file:e,index:t},t));return _jsx("div",{className:"aio-input-files",style:{direction:n?"rtl":"ltr"},children:o})}let FileItem=e=>{let{rootProps:t,types:n}=useContext(AICTX),{onChange:i=()=>{},value:o=[]}=t,{file:r,index:a}=e;function l(e){let t=e.name||"untitle",n=e.size||0,i=20;try{let o,r,a=t.lastIndexOf("."),l=t.slice(0,a),s=t.slice(a+1,t.length);o=l.length>i?l.slice(0,Math.floor(i/2))+"..."+l.slice(l.length-Math.floor(i/2),l.length)+"."+s:t;let u=n;if(!u)return{minName:o,sizeString:!1};let d=u/1073741824,c=u/1048576,p=u/1024;return r=d>=1?d.toFixed(2)+" GB":c>=1?c.toFixed(2)+" MB":p>=1?p.toFixed(2)+" KB":u+" byte",{minName:o,sizeString:r}}catch(g){return{minName:"untitle",sizeString:!1}}}function s(e,n){return __awaiter(this,void 0,void 0,function*(){if(e.stopPropagation(),e.preventDefault(),"function"==typeof t.onRemove){let r=yield t.onRemove({row:o[n],rowIndex:n});if(!1===r)return}let a=[];for(let l=0;l<o.length;l++)l!==n&&a.push(o[l]);i(a)})}function u(){UT.DownloadFile(r)}function d(){let e;return(t.preview&&(e=UT.FilePreview(r,{onClick:()=>u()})),e&&null!==e)?e:_jsx("div",{className:"aio-input-file-item-icon",onClick:()=>u(),children:I("mdiAttachment",.8)})}let{minName:c,sizeString:p}=l(r),{optionsList:g}=GetOptions({rootProps:t,types:n,options:[{minName:c,sizeString:p,index:a}],optionProp:Object.assign(Object.assign({},t.option),{subtext:()=>p,text:()=>c,before:()=>d(),after:()=>_jsx("div",{className:"aio-input-file-item-icon",onClick:e=>s(e,a),children:I("mdiClose",.7)})})});return _jsx(Layout,{option:g[0]})},Select=()=>{let{rootProps:e,types:t,options:n}=useContext(AICTX),{value:i}=e,o=Array.isArray(i)?[...i]:void 0!==i?[i]:[];function r(){if(!o.length)return;let e=n.optionsDic["a"+o[0]];if(e)return e.text}return t.isMultiple?_jsxs("div",{className:"aio-input-multiselect-container",children:[_jsx(Layout,{}),!e.hideTags&&!!o.length&&_jsx(Tags,{})]}):_jsx(Layout,{properties:{text:e.text||r()}})},DateInput=()=>{let{rootProps:e,types:t}=useContext(AICTX),{value:n,hideTags:i,calendarMode:o}=e,r=Array.isArray(n)?[...n]:void 0!==n?[n]:[];function a(){let{value:t,unit:n=Def("date-unit"),text:i,pattern:o,jalali:r,placeholder:a}=e;if(t){i=void 0!==o?o:i;let l=new AIODate,s=l.convertToArray(t),[u,d=1,c=1,p=0]=s;s=[u,d,c,p];let g=l.getSplitter(t),f="";if(i&&null!==i)f=i;else{let h="{}";"month"===n?h=`{year}${g}{month}`:"day"===n?h=`{year}${g}{month}${g}{day}`:"hour"===n&&(h=`{year}${g}{month}${g}{day} - {hour} : 00`),f=l.getDateByPattern(s,h)}return _jsx("div",{style:{direction:"ltr",width:"fit-content"},children:f})}return a||(r?"انتخاب تاریخ":"Select Date")}return o?_jsx(Calendar,{}):t.isMultiple?_jsxs("div",{className:"aio-input-multiselect-container",children:[_jsx(Layout,{properties:{text:e.text||"Select Dates"}}),!i&&!!r.length&&_jsx(Tags,{})]}):_jsx(Layout,{properties:{text:a()}})},Tags=()=>{let{rootProps:e,options:t}=useContext(AICTX),{value:n=[],rtl:i,disabled:o,onChange:r=()=>{}}=e,a=n.map((n,i)=>{let o=t.optionsDic["a"+n];return void 0===o?null:_jsx(Tag,{onClose:()=>r(e.value.filter(e=>e!==n)),attrs:o.tagAttrs,before:o.tagBefore,after:o.tagAfter,text:o.text,disabled:o.disabled},i)});return a.length?_jsx("div",{className:`aio-input-tags-container aio-input-scroll${i?" rtl":""}${o?" disabled":""}`,children:a}):null},Tag=e=>{let{attrs:t,before:n=I("mdiCircleMedium",.7),after:i,text:o,disabled:r,onClose:a=()=>{}}=e,l=r?void 0:a,s="aio-input-tag",u;return _jsxs("div",Object.assign({},UT.AddToAttrs(t,{className:[s+" aio-input-main-bg",r?"disabled":void 0]}),{children:[_jsx("div",{className:`${s}-icon`,children:n}),_jsx("div",{className:`${s}-text`,children:o}),void 0!==i&&_jsx("div",{className:`${s}-icon`,children:i}),_jsx("div",{className:`${s}-icon`,onClick:l,children:I("mdiClose",.7)})]}))},Input=()=>{let{rootProps:e,types:t,showPassword:n,options:i}=useContext(AICTX),{type:o,delay:r=500}=e,{maxLength:a=1/0,spin:l=!0}=e,{filter:s=[]}=e,[u]=useState(createRef()),[d]=useState({atimeout:void 0,btimeout:void 0,clicked:!1}),[c]=useState(`ac${Math.round(1e5*Math.random())}`),[p,g]=useState(e.value||""),f=useRef(p);function h(){"number"===o&&e.swip&&new UT.Swip({speedY:e.swip,reverseY:!0,minY:e.min,maxY:e.max,dom:()=>$(u.current),start(){let e=+f.current;return[0,e=isNaN(e)?0:e]},move(t){let{y:n}=t.change||{y:0};void 0!==e.min&&n<e.min&&(n=e.min),void 0!==e.max&&n>e.max&&(n=e.max),y(n,e.onChange)}})}function m(){let t=e.value;if("number"===o){if(""===t)return;!isNaN(+t)&&(t=+t,"number"==typeof e.min&&t<e.min?t=e.min:"number"==typeof e.max&&t>e.max&&(t=e.max))}return t}function v(){clearTimeout(d.atimeout),d.atimeout=setTimeout(()=>{let e=m();e!==p&&g(e)},r)}function y(n,i){Array.isArray(s)||(s=[]),t.hasKeyboard&&(n=UT.keyboard_filter(n,{maxLength:a,filter:s,toPersian:!0})),"number"===e.type&&(n=""===n?void 0:+n),g(n),!e.blurChange&&i&&(clearTimeout(d.btimeout),d.btimeout=setTimeout(()=>i(n),r))}function _(){!1!==e.autoHighlight&&!d.clicked&&(d.clicked=!0,$(u.current).focus().select())}function x(t){d.clicked=!1,e.blurChange&&t&&t(p)}function b(){let t=Object.assign(Object.assign({},UT.AddToAttrs(e.inputAttrs,{className:l?void 0:"no-spin",style:e.justify?{textAlign:"center"}:void 0})),{value:p,type:o,ref:u,disabled:e.disabled,placeholder:e.placeholder,list:e.options?c:void 0,onClick:e=>_(),onChange:e.onChange?t=>y(t.target.value,e.onChange):void 0,onBlur:()=>x(e.onChange)});return"password"===o&&n&&(t=Object.assign(Object.assign({},t),{type:"text",style:Object.assign(Object.assign({},t.style),{textAlign:"center"})})),1===s.length&&"number"===s[0]&&(t.pattern="d*",t.inputMode="numeric"),t}f.current=p,useEffect(()=>{h()},[]),useEffect(()=>{v()},[e.value]);let C=b();return C.onChange?"color"===o?_jsxs("label",{style:{width:"100%",height:"100%",background:p},children:[_jsx("input",Object.assign({},C,{style:{opacity:0}})),!!i.optionsList.length&&_jsx("datalist",{id:c,children:i.optionsList.map(e=>_jsx("option",{value:e.value}))})]}):"textarea"===o?_jsx("textarea",Object.assign({},C)):_jsx("input",Object.assign({},C)):p},Options=()=>{let{rootProps:e,types:t,options:n}=useContext(AICTX),[i,o]=useState(""),[r]=useState(createRef()),[a]=useState();function l(n){return"tabs"===e.type||"buttons"===e.type||t.isInput||!e.search||""===i&&n.length<10?null:_jsxs("div",{className:"aio-input-search",children:[_jsx("input",{type:"text",value:i,placeholder:e.search,onChange:e=>o(e.target.value)}),_jsx("div",{className:"aio-input-search-icon",onClick(){o("")},children:I(i?"mdiClose":"mdiMagnify",.8)})]})}function s(e){return e.map((e,t)=>i&&(void 0===e.text||""===e.text||null===e.text||-1===e.text.indexOf(i))?null:_createElement(Layout,Object.assign({},{option:e,index:t,searchValue:i},{key:t})))}function u(e){e.keyCode}if(useEffect(()=>{try{setTimeout(()=>$(r.current).focus(),30)}catch(e){}},[]),!n.optionsList.length)return null;let d=s(n.optionsList),c=`aio-input-options aio-input-scroll aio-input-${e.type}-options`;return t.isDropdown&&(c+=" aio-input-dropdown-options"),_jsxs("div",{className:"aio-input-options-container",ref:r,tabIndex:0,onKeyDown:e=>u(e),children:[l(n.optionsList),_jsx("div",{className:c,children:d})]})},CheckIcon=e=>{if(void 0===e.checked)return null;let{rootProps:t}=e,n=!t.multiple&&"radio"===t.type;if(t.checkIcon){let i=t.checkIcon({checked:e.checked,row:e.row,rootProps:t});return!1===i?null:_jsx(_Fragment,{children:i})}return t.switch?_jsx(AISwitch,Object.assign({},t.switch,{value:e.checked})):_jsx("div",{className:"aio-input-check-out aio-input-main-color"+(e.checked?" checked":"")+(n?" aio-input-check-round":""),style:{background:"none"},children:_jsx("div",{className:"aio-input-main-bg aio-input-check-in"})})},Layout=e=>{let{rootProps:t,datauniqid:n,types:i,touch:o,DragOptions:r,click:a,optionClick:l,showPassword:s,setShowPassword:u,popup:d}=useContext(AICTX),{option:c,index:p}=e,{type:g,rtl:f}=t,[h]=useState(createRef()),[m,v]=useState();function $(){let e;if(void 0!==c?(e=`aio-input-option aio-input-${g}-option`,i.isMultiple&&(e+=` aio-input-${g}-multiple-option`),i.isDropdown&&(e+=" aio-input-dropdown-option"),!0===c.details.active&&(e+=" active","tabs"===g&&(e+=" aio-input-main-color"),"buttons"===g&&(e+=" aio-input-main-bg"))):(e=`aio-input aio-input-${g}${o?" aio-input-touch":""}`,i.isInput&&(e+=" aio-input-input"),t.justify&&(e+=" aio-input-justify"),e+=f?" aio-input-rtl":" aio-input-ltr"),"tree"===g){let r=t.size||Def("tree-size");(r=12*Math.round(r/12))<24&&(r=24),r>120&&(r=120),e+=` aio-input-size-${r}`}return!0===O.disabled&&(e+=" disabled"),O.className&&(e+=" "+O.className),e+=" "+n}function y(e,t){let n=`aio-input-${e}`;return c?n+=` aio-input-${g}-option-${e}`:n+=` aio-input-${g}-${e}`,t&&(n+=" aio-input-has-subtext"),n}function _(){let{text:e,placeholder:t,subtext:n,justify:o}=O;if(void 0===e&&void 0!==t&&(e=_jsx("div",{className:"aio-input-placeholder",children:t})),void 0===e)return _jsx("div",{style:{flex:1}});{let r=`${y("value",!!n)}${o&&!i.isInput?" aio-input-value-justify":""}`;return _jsx("div",{className:r,"data-subtext":n,children:e})}}function x(e){let t=e.keyCode;13===t&&a(e,h)}function b(){return O.draggable?_jsx("svg",{viewBox:"8 4 10 13",role:"presentation",style:{width:12,height:"1.8rem"},children:_jsx("path",{d:"M9,3H11V5H9V3M13,3H15V5H13V3M9,7H11V9H9V7M13,7H15V9H13V7M9,11H11V13H9V11M13,11H15V13H13V11M9,15H11V17H9V15M13,15H15V17H13V15M9,19H11V21H9V19M13,19H15V21H13V19Z",style:{fill:"currentcolor"}})}):null}function C(){if(!i.isDropdown||c||i.isInput&&!t.options)return null;let{caret:e}=t;return!1===e?null:_jsx("div",{className:"aio-input-caret",children:void 0===e?I("mdiChevronDown",.8):e})}function A(e){let n;if("after"===e&&"password"===g&&t.preview)n=_jsx("div",{className:"aio-input-password-preview",onClick:()=>u(),children:I(s?"mdiEyeOff":"mdiEye",.8)},`layout${e}`);else{let i=O[e];n="function"==typeof i?i():i}return void 0===n?null:_jsx("div",{className:y(e),children:n},"layout"+e)}function w(){let{loading:e}=O,t;return e?(t=!0===e?I("mdiLoading",.8,{spin:.8}):e,_jsx("div",{className:y("loading"),children:t})):null}function N(){let{attrs:n,disabled:i,draggable:o,style:s}=O,u;d.getModals().length&&!c&&-1!==["text","number","textarea"].indexOf(g)&&(u=1e5);let f;i||(f=void 0===c?e=>{e.stopPropagation(),a(e,h)}:t=>{t.stopPropagation(),t.preventDefault(),(e.properties||{}).onClick?e.properties.onClick():l(c)}),n=UT.AddToAttrs(n,{className:$(),style:Object.assign(Object.assign({},s),{zIndex:u})});let m=Object.assign(Object.assign({tabIndex:c?void 0:1,onKeyDown:x},n),{onClick:f,ref:h,disabled:i}),v="function"==typeof t.options?t.options():t.options||[];return o&&(m=Object.assign(Object.assign(Object.assign({},m),r.getDragAttrs({fromIndex:p||0})),r.getDropAttrs({options:v,toIndex:p||0}))),p&&(m["data-index"]=p),m}function k(){let n=e.properties||{},i=c||t,{draggable:o=!!c&&c.draggable}=n,{placeholder:r=c?void 0:t.placeholder}=n,{checked:a=c?c.checked:"checkbox"===g?!!t.value:void 0}=n,{disabled:l=i.disabled}=n,{text:s=i.text}=n,{subtext:u=i.subtext}=n,{justify:d=i.justify}=n,{loading:p=i.loading}=n,{attrs:f=i.attrs||{}}=n,h=Object.assign(Object.assign({},i.style||{}),n.style),{before:m=i.before}=n,{after:v=i.after}=n,$=[i.className,n.className].filter(e=>!!e),y=$.length?$.join(" "):void 0;return{disabled:l,draggable:o,text:s,subtext:u,placeholder:r,justify:d,checked:a,loading:p,attrs:f,style:h,before:m,after:v,className:y}}function T(){m.start()}function D(){return m?_jsx("div",{className:"aio-input-voice",onClick:()=>T(),children:I("mdiMicrophoneOutline",.8)}):null}useEffect(()=>{if(!("webkitSpeechRecognition"in window))return;let{onChange:e,voice:n}=t;if(!n||!e||!i.hasKeyboard)return;let o=window.SpeechRecognition||window.webkitSpeechRecognition;if(!o)return;let r=new o;return r.lang=({en:"en-US",fa:"fa-IR"})[n],r.continuous=!0,r.interimResults=!1,r.onresult=t=>{let n=t.results[0][0].transcript;e&&e(n)},r.onerror=e=>{console.error("خطا در تشخیص گفتار: ",e.error)},r.onend=()=>{console.log("تشخیص گفتار پایان یافت.")},v(r),()=>{r.stop()}},[]);let O=k(),P=_jsxs(_Fragment,{children:[b(),"boolean"==typeof O.checked&&_jsx(CheckIcon,{rootProps:t,checked:O.checked,row:c||{}}),A("before"),_(),A("after"),w(),D(),C()]}),R=N();return"file"===g?_jsxs("label",Object.assign({},R,{children:[P,_jsx(InputFile,{})]})):_jsxs("div",Object.assign({},R,{children:[P,!!c&&"tabs"===g&&_jsx("div",{className:"aio-input-tabs-option-bar"})]}))},List=()=>{let{rootProps:e,options:t}=useContext(AICTX),{attrs:n={},size:i=36,listOptions:o={count:3,editable:!0,stop:3,decay:8},onChange:r=()=>{}}=e,{count:a=3,editable:l=!0,stop:s=3,decay:u=8}=o,d=t.optionsList.length,[c]=useState({dom:createRef(),activeIndex:0,interval:void 0,moved:!1,lastY:0,deltaY:0,so:{y:0,top:0,limit:{top:0,bottom:0}}});function p(){var e=a*i;return{height:e}}function g(e){return Math.round((a*i-i-2*e)/(2*i))}function f(e){return(a-2*e-1)*i/2}function h(){return{top:f(c.activeIndex)}}function m(e){if(e.preventDefault(),c.activeIndex>=d-1)return;c.activeIndex++;let t=f(c.activeIndex);k({top:t}),v(c.activeIndex)}function v(e){$(c.dom.current).find(".aio-input-list-option").removeClass("active"),$(c.dom.current).find(".aio-input-list-option[data-index="+e+"]").addClass("active")}function y(){if(c.activeIndex<=0)return;c.activeIndex--;let e=f(c.activeIndex);k({top:e}),v(c.activeIndex)}function _(e){l&&(38===e.keyCode?y():40===e.keyCode&&m(e))}function x(){return{top:f(-1),bottom:f(d)}}function b(e){let t=g(e);return t<0&&(t=0),t>d-1&&(t=d-1),f(t)}function C(e){if(!l)return;UT.EventHandler("window","mousemove",N,"bind"),UT.EventHandler("window","mouseup",T,"bind"),clearInterval(c.interval),c.moved=!1;let n=UT.GetClient(e).y;k({transition:"unset"});let i=A();var o=g(i);v(o),k({top:i,transition:"unset"}),r(t.optionsList[o].value,o),c.so={y:n,top:i,limit:x()}}function A(){var e=parseInt($(c.dom.current).find(".aio-input-list-options").css("top"));return b(e)}function w(e){let{top:t,bottom:n}=c.so.limit;return e>t?t:e<n?n:e}function N(e){e.preventDefault(),e.stopPropagation(),console.log("move"),c.moved=!0;let t=UT.GetClient(e).y;var n=t-c.so.y;void 0===c.lastY&&(c.lastY=t),c.deltaY=t-c.lastY,c.lastY=t,20>Math.abs(n)&&(c.deltaY=3);var i=w(c.so.top+n);let o=g(i);c.so.newTop=i,v(o),k({top:i})}function k(e){$(c.dom.current).find(".aio-input-list-options").css(e)}function T(){UT.EventHandler("window","mousemove",N,"unbind"),UT.EventHandler("window","mouseup",T,"unbind"),c.moved&&(c.moved=!1,D(c.deltaY,c.so.newTop))}function D(e,n=A()){u<0&&(u=0),u>99&&(u=99),u=1+u/1e3,c.interval=setInterval(()=>{let i=g(n+=e);if(v(i),Math.abs(e)<s||i<0||i>d-1){clearInterval(c.interval),i<0&&(i=0),i>d-1&&(i=d-1);let o=f(i);k({top:o,transition:"0.3s"});let a=t.optionsList[i];r(a.value,a.details);return}e/=u,k({top:n})},20)}useEffect(()=>{var t;(null===(t=e.listOptions)||void 0===t?void 0:t.move)&&e.listOptions.move(D)},[]),useEffect(()=>{v(c.activeIndex)});let O=t.optionsList.map((t,n)=>(t.value===e.value&&(c.activeIndex=n),_jsx(Layout,{option:t,index:n,properties:{style:{height:i},justify:!0}},n)));return _jsx("div",Object.assign({},n,{ref:c.dom,tabIndex:0,onKeyDown:e=>_(e),className:"aio-input-list"+(n.className?" "+n.className:""),style:Object.assign(Object.assign({},n.style),p()),children:_jsx("div",{className:"aio-input-list-options",style:h(),onMouseDown:e=>C(e),onTouchStart:e=>C(e),children:O})}))},AcardionContext=createContext({});export const Acardion=()=>{let{rootProps:e,options:t}=useContext(AICTX),{multiple:n,vertical:i=!0,value:o}=e;function r(e){return n?-1!==(o||[]).indexOf(e):e===o}function a(){return{rootProps:e,isOpen:r}}return _jsx(AcardionContext.Provider,{value:a(),children:_jsx("div",{className:`aio-input-acardion aio-input-scroll${i?" aio-input-acardion-vertical":" aio-input-acardion-horizontal"}`,children:t.optionsList.map((e,t)=>_jsx(AcardionItem,{option:e},t))})})};let AcardionItem=({option:e})=>{let t=!!e.details.active,[n]=useState();return _jsxs("div",Object.assign({},UT.AddToAttrs(e.attrs,{className:"aio-input-acardion-item"}),{children:[_jsx(Layout,{option:e}),!!t&&_jsx(AcardionBody,{option:e})]}))},AcardionBody=({option:e})=>{let{rootProps:t}=useContext(AcardionContext),{body:n=()=>{}}=t,{html:i,attrs:o}=n(e.optionOrg,e.details)||{html:""};return _jsx("div",Object.assign({},UT.AddToAttrs(o,{className:["aio-input-acardion-body"]}),{children:i}))},TreeContext=createContext({}),Tree=()=>{let{rootProps:e,types:t}=useContext(AICTX),{onAdd:n,onRemove:i,value:o=[],onChange:r,size:a=Def("tree-size"),attrs:l}=e,[s,u]=useState({}),d=useRef(s);d.current=s;let[c,p]=useState({}),g=useRef(c);g.current=c;let[f]=useState(v);function h(e){p(Object.assign(Object.assign({},g.current),{[e]:!g.current[e]}))}function m(e){u(Object.assign(Object.assign({},d.current),{[e]:!d.current[e]}))}function v(){let{indent:t=24}=e;return"number"!=typeof t&&(t=12),(t=6*Math.round(t/6))<0&&(t=0),t>60&&(t=60),t}function $(e){let t=!!s[e],n=300;t?(h(e),setTimeout(()=>m(e),n)):(m(e),setTimeout(()=>h(e),0))}function y(t,n){for(let i in n)t[i]=n[i];e.onChange&&e.onChange(e.value)}function _(t){let{row:n,details:i}=t,o=[];try{o=e.getChilds?e.getChilds({row:n,details:i}):n.childs||[]}catch(r){o=[]}return o||[]}function x(t){let{row:n,childs:i}=t;try{e.setChilds?e.setChilds(t):n.childs=i}catch(o){}}function b(e){return __awaiter(this,void 0,void 0,function*(){let t;if(t="function"==typeof n?yield n(e):n){if(e){let i=_({row:e.parent,details:e.parentDetails});x({row:e.parent,childs:i.concat(t),details:e.parentDetails})}else o.push(t);r&&r(o)}})}function C(t){return __awaiter(this,void 0,void 0,function*(){let{index:n}=t,a;if(!(a="function"!=typeof i||(yield i(t))))return;let l={index:n,active:!1,toggle(){}},{option:s={}}=e;if(t.parent){let u=_({row:t.parent,details:t.parentDetails}).filter(n=>{let i=GetOptionProps({key:"value",optionProp:s,optionOrg:t.row,optionDetails:Object.assign(Object.assign({},l),{rootProps:e})}),o=GetOptionProps({key:"value",optionProp:s,optionOrg:n,optionDetails:Object.assign(Object.assign({},l),{rootProps:e})});return i!==o});x({row:t.parent,details:t.parentDetails,childs:u})}else o=o.filter(n=>{let i=GetOptionProps({key:"value",optionProp:s,optionOrg:t.row,optionDetails:Object.assign(Object.assign({},l),{rootProps:e})}),o=GetOptionProps({key:"value",optionProp:s,optionOrg:n,optionDetails:Object.assign(Object.assign({},l),{rootProps:e})});return i!==o});r&&r(o)})}function A(){return{toggle:$,rootProps:e,mountedDic:c,openDic:s,add:b,remove:C,types:t,indent:f,size:a,change:y,getChilds:_}}useEffect(()=>{e.toggleRef&&(e.toggleRef.current=e=>$(e))},[$]),useEffect(()=>{e.onToggle&&e.onToggle(s)},[s]);let w=UT.AddToAttrs(l,{className:["aio-input-tree",e.className,e.rtl?"aio-input-tree-rtl":void 0],style:e.style});return _jsx(TreeContext.Provider,{value:A(),children:_jsxs("div",Object.assign({},w,{children:[_jsx(TreeHeader,{}),_jsx(TreeBody,{rows:o,level:0})]}))})},TreeHeader=()=>{let{rootProps:e,add:t}=useContext(TreeContext),{addText:n="add",onAdd:i}=e;return i?(n=("function"==typeof n?n("header"):n)||"add",_jsx("div",{className:"aio-input-tree-header",children:_jsxs("button",{onClick:()=>t(),children:[I("mdiPlusThick",.8),n]})})):null},TreeActions=e=>{let{row:t,index:n,parent:i,rowDetails:o,parentDetails:r}=e,{rootProps:a,add:l,remove:s}=useContext(TreeContext),{onAdd:u,onRemove:d,removeText:c="Remove"}=a,p=("function"==typeof a.addText?a.addText(t):a.addText)||"Add",g="function"==typeof a.actions?a.actions(t,i):a.actions;function f(){let e=[];return u&&e.push({text:p,value:"add",before:I("mdiPlusThick",.7),onClick:()=>l({parent:t,parentDetails:o})}),e=[...e,...(g||[]).map(e=>Object.assign(Object.assign({},e),{onClick(){e.onClick&&e.onClick(t,i)}}))],d&&e.push({text:c,value:"remove",before:I("mdiDelete",.7),onClick:()=>s({row:t,index:n,parent:i,parentDetails:r})}),e}let h=f();if(!h.length)return null;let m={type:"select",caret:!1,popover:{limitTo:".aio-input-tree"},className:"aio-input-tree-options-button",options:h,text:I("mdiDotsHorizontal",.7)};return _jsx(AIOInput,Object.assign({},m))},TreeBody=e=>{let{rootProps:t,types:n,openDic:i,mountedDic:o,indent:r,size:a,change:l,getChilds:s,toggle:u}=useContext(TreeContext),{rows:d,level:c,parent:p,parentId:g,parentIndent:f,parentDetails:h}=e,m=void 0===g||!!i[g],v=void 0==g||o[g],{onAdd:$,onRemove:y,actions:_}=t,{optionsList:x}=GetOptions({rootProps:t,types:n,options:d,level:c,isOpen:e=>!!i[e],change:(e,t)=>l(e,t),optionProp:t.option||{}});function b(){let e="aio-input-tree-body";return p||(e+=" aio-input-tree-root"),m&&(e+=" open"),e+=v?" mounted":" not-mounted",e+=` aio-input-tree-body-level-${c}`}return($||y||_)&&(x=x.map(e=>{let{index:t,level:n=0}=e.details,i=0===t,o=t===d.length-1,r={index:t,level:n,isFirstChild:i,isLastChild:o},a=_jsx(TreeActions,{row:e.optionOrg,index:t,parent:p,rowDetails:r,parentDetails:h});return Object.assign(Object.assign({},e),{after:a})})),_jsx("div",{className:b(),children:x.map((e,t)=>{let n=d[t],o=e.value,l={level:c,index:t,isLastChild:t===x.length-1,isFirstChild:0===t},u=s({row:n,details:l}),h=!!i[o],v={row:n,option:e,parent:p,parentId:g,id:o,parentOpen:m,open:h,details:l,indent:Object.assign({height:a,childsLength:u.length,size:r,parentIndent:f},l)};return _jsxs(Fragment,{children:[_jsx(TreeRow,{item:v}),_jsx(TreeChilds,{item:v})]},t)})})},TreeRow=e=>{let{openDic:t,getChilds:n,toggle:i,rootProps:o}=useContext(TreeContext),{item:r}=e,a=n(r),l=a.length?!!t[r.id]:void 0,{row:s,indent:u,option:d}=r,{level:c,size:p,height:g}=u,{checked:f}=d,h=()=>{var e;return[_jsx(Indent,{row:s,width:p,height:g,level:c,isLastChild:r.indent.isLastChild,isLeaf:!a||!a.length,isParentLastChild:!!(null===(e=r.indent.parentIndent)||void 0===e?void 0:e.isLastChild),rtl:!!o.rtl,toggleIcon:o.toggleIcon,open:l,onToggle:()=>i(r.id)}),_jsx(_Fragment,{children:void 0===f?null:_jsx(CheckIcon,{checked:f,rootProps:o,row:s})}),_jsx(_Fragment,{children:r.option.before||null})]},m={option:Object.assign(Object.assign({},r.option),{before:h(),checked:void 0})};return _jsx(Layout,Object.assign({},m))},TreeChilds=e=>{let{getChilds:t}=useContext(TreeContext),{row:n,id:i,open:o,indent:r,details:a}=e.item,l=t(e.item);return o&&l&&l.length?_jsx(TreeBody,{rows:l,level:r.level+1,parent:n,parentId:i,parentIndent:r,parentDetails:a}):null},DPContext=createContext({});export function Calendar(e){let{rootProps:t,DATE:n}=useContext(AICTX),{onClose:i}=e,{multiple:o,unit:r=Def("date-unit"),jalali:a,value:l,disabled:s,size:u=12,theme:d=Def("theme"),translate:c,onChange:p=()=>{},option:g={}}=t,[f]=useState(n.getMonths(a)),[h]=useState(n.getToday(a)),[m]=useState(n.getWeekDay(h).weekDay),[v]=useState(f[h[1]-1]),[$,y]=useState(w),[_,x]=useState(null),[b,C]=useState(!1);function A(){let e;return o?l.length?l[l.length-1]:void 0:l}function w(){let e=A();e=e&&null!==e?e:h;let[t,i,o]=n.convertToArray(e);return{year:t,month:i,day:o}}let N=useRef($);function k(e){if(c){let t=c(e);if(t)return t}"Today"===e&&("month"===r?e="This Month":"hour"===r&&(e="This Hour"));let n={Clear:"حذف","This Hour":"ساعت کنونی",Today:"امروز","This Month":"ماه جاری","Select Year":"انتخاب سال",Close:"بستن"},i=e;return a&&n[e]&&(i=n[e]),i}function T(e){b=!1,null===e?(C(!1),setTimeout(()=>x(null),300)):(x(e),setTimeout(()=>C(!0),0))}function D(e){let t;if("today"===e){let[n,i,o]=h;t={year:n,month:i,day:"month"===r?1:o}}else t=Object.assign(Object.assign({},$),e);y(t)}function O(){return{fontSize:u,background:d[1],color:d[0],stroke:d[0],cursor:!0===s?"not-allowed":void 0}}function P(){let e=A();return"string"==typeof e?n.getSplitter(e):"/"}function R(){return{changeActiveDate:D,DATE:n,changePopup:T,translate:k,rootProps:t,activeDate:N.current,today:h,todayWeekDay:m,thisMonthString:v,months:f,onChange(e){let{year:s=1e3,month:u=1,day:d=1,hour:c=0}=e,h=[s,u,d,c],m=a?h:n.toJalali(h),v=a?n.toGregorian(h):h,{weekDay:$,index:y}="month"===r?{weekDay:"",index:0}:n.getWeekDay(h),_=e=>{if(void 0===e)return;let t=e.toString();return 1===t.length?`0${t}`:t},x="",b=P();"month"===r?x=`${s}${b}${_(u)}`:"day"===r?x=`${s}${b}${_(u)}${b}${_(d)}`:"hour"===r&&(x=`${s}${b}${_(u)}${b}${_(d)}${b}${_(c)}`);let C=f[u-1],A=a?C:n.getMonths(!0)[u-1],w=a?n.getMonths(!1)[u-1]:C,N={months:f,jalaliDateArray:m,gregorianDateArray:v,dateArray:h,weekDay:$,weekDayIndex:y,dateString:x,year:s,month:u,day:d,hour:c,monthString:C,jalaliMonthString:A,gregorianMonthString:w},k,T=0;if(o){let D=[],O=(D=l?Array.isArray(l)?[...l]:[l]:[]).indexOf(x);if(k=-1===O?[...D,x]:D.filter(e=>e!==x),"number"==typeof o)for(;k.length>o;)k=k.slice(1,k.length);O=k.length-1}else T=0,k=x;p(k,N),i&&"function"==typeof g.close&&g.close(void 0,{index:T,rootProps:t})&&i()}}}return N.current=$,_jsxs(DPContext.Provider,{value:R(),children:[_jsxs("div",{className:"aio-input-date-container aio-input-date-theme-bg",style:{display:"flex",fontSize:u},children:[_jsxs("div",{className:"aio-input-date-calendar",style:O(),children:[_jsx(DPHeader,{}),_jsx(DPBody,{}),_jsx(DPFooter,{})]}),_jsx(DPToday,{})]}),_jsx("div",{className:`aio-input-date-popup-container ${b?"mounted":"not-mounted"}`,children:_})]})}function DPToday(){let{rootProps:e,translate:t,today:n,todayWeekDay:i,thisMonthString:o}=useContext(DPContext),{theme:r=Def("theme"),jalali:a,unit:l=Def("date-unit")}=e;return _jsxs("div",{className:"aio-input-date-today aio-input-date-theme-active",style:{color:r[1],background:r[0]},children:[_jsx("div",{className:"aio-input-date-today-label",children:t("Today")}),"month"!==l&&_jsx("div",{className:"aio-input-date-today-weekday",children:a?i:i.slice(0,3)}),"month"!==l&&_jsx("div",{className:"aio-input-date-today-day",children:n[2]}),_jsx("div",{className:"aio-input-date-today-month",children:a?o:o.slice(0,3)}),_jsx("div",{className:"aio-input-date-today-year",children:n[0]}),"hour"===l&&_jsx("div",{className:"aio-input-date-today-year",children:n[3]+":00"})]})}function DPFooter(){let{rootProps:e,changeActiveDate:t,translate:n}=useContext(DPContext),{disabled:i,onChange:o=()=>{},deSelect:r,multiple:a,now:l=!0}=e;if(i)return null;let s="aio-input-date-theme-color";function u(){"function"==typeof r?r():o(a?[]:void 0)}return _jsxs("div",{className:"aio-input-date-footer",children:[!!r&&_jsx("button",{onClick:()=>u(),className:s,children:n("Clear")}),!!l&&_jsx("button",{onClick:()=>t("today"),className:s,children:n("Today")})]})}function DPBody(){let{rootProps:e,activeDate:t}=useContext(DPContext),{unit:n=Def("date-unit"),jalali:i}=e;function o(){let e="aio-input-date-body";return e+=` aio-input-date-body-${n}`,e+=` aio-input-date-${i?"rtl":"ltr"}`}return _jsxs("div",{className:o(),children:["hour"===n&&UT.GetArray(24,e=>_jsx(DPCell,{dateArray:[t.year,t.month,t.day,e]},"cell"+e)),"day"===n&&_jsx(DPBodyDay,{}),"month"===n&&UT.GetArray(12,e=>_jsx(DPCell,{dateArray:[t.year,e+1]},"cell"+e))]})}function DPBodyDay(){let{rootProps:e,activeDate:t,DATE:n}=useContext(DPContext),{theme:i=Def("theme"),jalali:o}=e,r=n.getWeekDay([t.year,t.month,1]).index,a=n.getMonthDaysLength([t.year,t.month]);return _jsxs(_Fragment,{children:[n.getWeekDays(o).map((e,t)=>_jsx(DPCellWeekday,{weekDay:e},"weekday"+t)),UT.GetArray(r,e=>_jsx("div",{className:"aio-input-date-space aio-input-date-cell",style:{background:i[1]}},"space"+e)),UT.GetArray(a,e=>_jsx(DPCell,{dateArray:[t.year||0,t.month||0,e+1]},"cell"+e)),UT.GetArray(42-(r+a),e=>_jsx("div",{className:"aio-input-date-space aio-input-date-cell",style:{background:i[1]}},"endspace"+e))]})}let DPCellWeekday=e=>{let{rootProps:t,translate:n}=useContext(DPContext),{theme:i=Def("theme"),jalali:o}=t,{weekDay:r}=e;return _jsx("div",{className:"aio-input-date-weekday aio-input-date-cell aio-input-date-theme-color",style:{background:i[1],color:i[0]},children:_jsx("span",{children:n(r.slice(0,o?1:2))})})};function DPCell(e){let{rootProps:t,translate:n,onChange:i,DATE:o}=useContext(DPContext),{disabled:r,dateAttrs:a,theme:l=Def("theme"),value:s,jalali:u,unit:d=Def("date-unit"),multiple:c}=t,{dateArray:p}=e;function g(){return c?!!s.length&&!!s.find(e=>o.isEqual(p,e)):!!s&&o.isEqual(p,s)}function f(e,t,n,i){var o="aio-input-date-cell";return n&&(o+=" aio-input-date-disabled"),e?o+=" aio-input-date-active aio-input-date-theme-active":o+=" aio-input-date-theme-color",t&&(o+=" today aio-input-date-theme-border"),i&&(o+=` ${i}`),o}let h=g(),m=o.isEqual(p,o.getToday(u)),v=o.isGreater(p,o.getToday(u)),$={};if(a){let{unit:y="day"}=t,_=null,x=null,b="";if("day"===y){let C=o.getWeekDay(p);_=C.weekDay,x=C.index}else if("month"===y){let A=o.getMonths(u);b=A[p[1]-1]}$=($=a({dateArray:p,isToday:m,isActive:h,isFuture:v,weekDayIndex:x,weekDay:_,monthString:b}))||{}}let w=!0===r||!0===$.disabled,N=f(h,m,w,$.className),k=w?void 0:()=>{i({year:p[0],month:p[1],day:p[2],hour:p[3]})},T={};w||(T.background=l[1],T.color=l[0]),-1!==N.indexOf("aio-input-date-active")&&(T.background=l[0],T.color=l[1]),-1!==N.indexOf("today")&&(T.border=`1px solid ${l[0]}`),T=Object.assign(Object.assign({},T),$.style);let D;if("hour"===d)D=p[3]+":00";else if("day"===d)D=p[2];else if("month"===d){let O=o.getMonths(u);D=n(u?O[p[1]-1]:O[p[1]-1].slice(0,3))}return _jsx("div",{style:T,onClick:k,className:N,children:w?_jsx("del",{children:D}):D})}function DPHeaderItem(e){let{unit:t}=e,{rootProps:n,activeDate:i,months:o,changePopup:r}=useContext(DPContext),{theme:a=Def("theme"),jalali:l}=n;if(!i||!i[t])return null;let s="year"===t?i.year:o[i[t]-1].substring(0,l?10:3);return _jsx("button",{type:"button",className:"aio-input-date-dropdown aio-input-date-theme-color",style:{color:a[0],background:a[1]},onClick:()=>r(_jsx(DPHeaderPopup,{onClose:()=>r(null),unit:t})),children:s})}let DPHeaderPopup=e=>{let{onClose:t,unit:n}=e,{rootProps:i,DATE:o,translate:r,activeDate:a,changeActiveDate:l}=useContext(DPContext),{jalali:s,theme:u=Def("theme")}=i,[d]=useState(o.getMonths(s)),[c,p]=useState(10*Math.floor(a.year/10)),[g,f]=useState(a.year),[h,m]=useState(a.month);function v(e){"year"===n?(f(e),l({year:e})):(m(e),l({month:e})),t()}function $(e){p(c+10*e)}function y(){let e=[],t=e=>{let t="aio-input-date-cell";return e?t+=" aio-input-date-active aio-input-date-theme-active":t+=" aio-input-date-theme-color",t};if("year"===n)for(let i=c;i<c+10;i++){let o=i===g,r={style:o?{background:u[0],color:u[1]}:{background:u[1],color:u[0]},className:t(o),onClick:()=>v(i)};e.push(_createElement("div",Object.assign({},r,{key:i}),i))}else for(let a=1;a<=12;a++){let l=a===h,p={style:l?{background:u[0],color:u[1]}:{background:u[1],color:u[0]},className:t(l),onClick:()=>v(a)},f=d[a-1];s||(f=`${f.slice(0,3)} (${a})`),e.push(_createElement("div",Object.assign({},p,{key:a}),f))}return e}function _(){return"year"!==n?null:_jsxs("div",{className:"aio-input-date-popup-header",children:[_jsx(DPArrow,{type:"minus",onClick:()=>$(-1)}),_jsx("div",{className:"aio-input-date-popup-label",children:r("Select Year")}),_jsx(DPArrow,{type:"plus",onClick:()=>$(1)})]})}function x(){return _jsx("div",{className:"aio-input-date-popup-body",children:y()})}function b(){let e=r("Close");return _jsx("div",{className:"aio-input-date-popup-footer",children:_jsx("button",{className:"aio-input-date-theme-color",onClick:()=>t(),children:e})})}return useEffect(()=>{f(a.year),m(a.month)},[a.year,a.month]),_jsxs("div",{style:{background:u[0],color:u[1]},className:"aio-input-date-popup aio-input-date-theme-bg"+(s?" aio-input-date-rtl":" aio-input-date-ltr"),children:[_(),x(),b()]})};function DPHeader(){let{rootProps:e,activeDate:t,changeActiveDate:n,DATE:i}=useContext(DPContext),{unit:o=Def("date-unit")}=e;function r(){if(!t||!t.year||!t.month)return null;let e=i.getMonthDaysLength([t.year,t.month]),o=UT.GetArray(e,e=>({text:(e+1).toString(),value:e+1}));return _jsx(DPHeaderDropdown,Object.assign({},{value:t.day,options:o,onChange:e=>n({day:e})}))}return _jsxs("div",{className:"aio-input-date-header",children:[_jsx(DPArrow,{type:"minus"}),_jsxs("div",{className:"aio-input-date-select",children:[_jsx(DPHeaderItem,{unit:"year"}),"month"!==o?_jsx(DPHeaderItem,{unit:"month"}):null,"hour"===o?r():null]}),_jsx(DPArrow,{type:"plus"})]})}function DPHeaderDropdown(e){let{rootProps:t}=useContext(DPContext),{value:n,options:i,onChange:o}=e,{theme:r=Def("theme")}=t;return _jsx(AIOInput,Object.assign({},{value:n,options:i,onChange:o,caret:!1,type:"select",attrs:{className:"aio-input-date-dropdown aio-input-date-theme-color"},option:{style:()=>({background:r[1],color:r[0]})}}))}function DPArrow(e){let{rootProps:t,changeActiveDate:n,activeDate:i,DATE:o}=useContext(DPContext),{type:r,onClick:a}=e,{jalali:l,unit:s=Def("date-unit"),theme:u=Def("theme")}=t;function d(){if(a){a();return}let e="minus"===r?-1:1,t=[i.year,i.month,i.day];if("month"===s&&n({year:i.year+e}),"day"===s){let u=[];n({year:(u=1===t[1]&&-1===e?[t[0]-1,12]:12===t[1]&&1===e?[t[0]+1,1]:[t[0],t[1]+e])[0],month:u[1]})}if("hour"===s){let d=o.getNextTime(t,864e5*e,l);n({year:d[0],month:d[1],day:d[2]})}}function c(){return I("minus"===r?"mdiChevronLeft":"mdiChevronRight",1,{color:u[0]})}return _jsx("div",{className:"aio-input-date-arrow aio-input-date-theme-color",onClick:()=>d(),children:c()})}let AITableContext=createContext({});function Table(){let{rootProps,DATE}=useContext(AICTX),{paging,getValue={},value,onChange=()=>{},onAdd,onRemove,excel,onSwap,onSearch,rowAttrs,onChangeSort,className,style}=rootProps,[dom]=useState(createRef()),[searchValue,setSearchValue]=useState(""),[columns,setColumns]=useState([]),[searchColumns,setSearchColumns]=useState([]),[excelColumns,setExcelColumns]=useState([]),[temp]=useState({}),[DragRows]=useState(!!onSwap&&new UT.DragClass({callback(e,t){if(!1===DragRows)return;let{dragIndex:n}=e,{dropIndex:i,rows:o}=t,r=DragRows.reOrder(o,n,i),a=o[n],l=o[i];"function"==typeof onSwap?onSwap(r,a,l):onChange(r)}})),[sorts,setSorts]=useState([]);function getColumns(){let{columns:e=[]}=rootProps;e="function"==typeof e?e():e;let t=[],n=[],i=e.map(e=>{let{id:i="aitc"+Math.round(1e6*Math.random()),sort:o,search:r,excel:a}=e,l=Object.assign(Object.assign({},e),{_id:i});return r&&t.push(l),a&&n.push(l),l});return setColumns(i),setSearchColumns(t),setExcelColumns(n),i}function getSorts(e){let t=[];for(let n=0;n<e.length;n++){let i=e[n],{_id:o,input:r}=i,a=!0===i.sort?{}:i.sort;if(!a)continue;let{active:l=!1,dir:s="dec"}=a,u;u=a.getValue?a.getValue:e=>{let t=getDynamics({value:i.value,row:e,column:i});return r&&"date"===r.type&&(t=DATE.getTime(t)),t};let d;d=r&&-1!==["number","date","range"].indexOf(r.type)?"number":a.type||"string";let c={dir:s,title:a.title||i.title,sortId:o,active:l,type:d,getValue:u};t.push(c)}setSorts(t)}function getDynamics(p){let{value,row,column,def,rowIndex}=p;if(paging){let{number,size}=paging;rowIndex&&(rowIndex+=(number-1)*size)}let type=typeof value;if("string"===type){let result=value,param={row,column:column,rowIndex:rowIndex};if(getValue[value])result=getValue[value](param);else if(-1!==value.indexOf("row."))try{eval(`result = ${value}`)}catch(_a){result=""}return void 0===result?def:result}return"undefined"===type?def:"function"===type?value({row,column,rowIndex}):void 0===value?def:value}function add(){"function"==typeof onAdd?onAdd():onChange([Object.assign({},onAdd),...value])}function remove(e,t){let n=()=>onChange(value.filter(t=>t._id!==e._id));"function"==typeof onRemove?onRemove({row:e,action:n,rowIndex:t}):n()}function exportToExcel(){let e=[];if("function"==typeof rootProps.excel)e=rootProps.excel(value);else for(let t=0;t<value.length;t++){let n=value[t],i={};for(let o=0;o<excelColumns.length;o++){let r=excelColumns[o],{excel:a,value:l}=r,s="";if(!0===a)s="string"==typeof r.title?r.title:"untitle";else{if("string"!=typeof a)continue;s=a}i[s]=getDynamics({value:l,row:n,column:r,rowIndex:t})}e.push(i)}UT.ExportToExcel(e,{promptText:"string"==typeof excel?excel:"Inter Excel File Name"})}function getSearchedRows(e){return!0===onSearch&&searchColumns.length&&searchValue?AIOInputSearch(e,searchValue,(e,t)=>{let n="";for(let i=0;i<searchColumns.length;i++){let o=searchColumns[i],r=getDynamics({value:o.value,row:e,def:"",column:o,rowIndex:t});r&&(n+=r+" ")}return n}):e}function sortRows(e,t){return e?t&&t.length?e.sort((e,n)=>{for(let i=0;i<t.length;i++){let{dir:o,getValue:r}=t[i];if(!r)break;let a=r(e),l=r(n);if(a<l)return -1*("dec"===o?-1:1);if(a>l)return 1*("dec"===o?-1:1);if(i===t.length-1)break}return 0}):e:[]}function getSortedRows(e){if(temp.isInitSortExecuted||onChangeSort)return e;let t=sorts.filter(e=>!1!==e.active);if(!t.length||!e.length)return e;temp.isInitSortExecuted=!0;let n=sortRows(e,t);return onChange(n),n}function getRows(){let e=getSearchedRows(value),t=getSortedRows(e),n=paging&&!paging.serverSide?t.slice((paging.number-1)*paging.size,paging.number*paging.size):t;return{rows:value,searchedRows:e,sortedRows:t,pagedRows:n}}function getCellStyle(e){let t=getDynamics({value:e.width}),n=getDynamics({value:e.minWidth});return{width:t||void 0,flex:t?void 0:1,minWidth:n}}function getCellAttrs(e){let{row:t,rowIndex:n,column:i,type:o}=e,{cellAttrs:r,titleAttrs:a}=i,l=getDynamics({value:"title"===o?a:r,column:i,def:{},row:t,rowIndex:n}),s=getDynamics({value:i.justify,def:!1}),u=`aio-input-table-${o}`+(s?` aio-input-table-${o}-justify`:"");return l=UT.AddToAttrs(l,{className:u,style:getCellStyle(i)}),"title"===o&&(l.title=getDynamics({value:i.title,def:""})),Object.assign({},l)}function getRowAttrs(e,t){let n=rowAttrs?rowAttrs({row:e,rowIndex:t}):{},i=UT.AddToAttrs(n,{className:"aio-input-table-row"});return!1!==DragRows&&(i=Object.assign(Object.assign(Object.assign({},i),DragRows.getDragAttrs({dragIndex:t})),DragRows.getDropAttrs({dropIndex:t,rows:value}))),i}function search(e){!0===onSearch?setSearchValue(e):"function"==typeof onSearch&&onSearch(e)}function getContext(e){return{ROWS:e,rootProps,columns,sorts,setSorts,sortRows,excelColumns,getCellAttrs,getRowAttrs,add,remove,search,exportToExcel,getDynamics}}useEffect(()=>{let e;getSorts(getColumns())},[]);let ROWS=getRows(),attrs=UT.AddToAttrs(rootProps.attrs,{className:["aio-input aio-input-table",className],style:rootProps.style,attrs:{ref:dom}});return _jsx(AITableContext.Provider,{value:getContext(ROWS),children:_jsxs("div",Object.assign({},attrs,{children:[_jsx(TableToolbar,{}),_jsxs("div",{className:"aio-input-table-unit aio-input-scroll",children:[_jsx(TableHeader,{}),_jsx(TableRows,{})]}),paging&&ROWS.rows.length?_jsx(TablePaging,{}):""]}))})}function TableGap(e){let{rootProps:t}=useContext(AITableContext),{rowGap:n,columnGap:i}=t,{dir:o}=e,r;return r="h"===o?{height:n}:{width:i},_jsx("div",{className:`aio-input-table-border-${o}`,style:r})}function TablePaging(){let{ROWS:e,rootProps:t}=useContext(AITableContext),[n]=useState({timeout:void 0,start:void 0,end:void 0,pages:0});function i(i){if("function"!=typeof t.onChangePaging)return alert("aio-input error => in type table you set paging but forget to set onChangePaging function prop to aio input"),{number:0,size:0};let{number:o,size:r=20,length:a=0,sizes:l=[1,5,10,15,20,30,50,70,100],serverSide:s}=i;s||(a=e.sortedRows.length),-1===l.indexOf(r)&&(r=l[0]);let u=Math.ceil(a/r),d=(o=(o=o>u?u:o)<1?1:o)-3,c=o+3;return n.start=d,n.end=c,n.pages=u,Object.assign(Object.assign({},i),{length:a,number:o,size:r,sizes:l})}let[o,r]=useState(i(t.paging||{size:0,number:0}));function a(e){let a=i(Object.assign(Object.assign({},o),e));r(a),t.onChangePaging&&(a.serverSide?(clearTimeout(n.timeout),n.timeout=setTimeout(()=>{t.onChangePaging&&t.onChangePaging(a)},800)):t.onChangePaging(a))}useEffect(()=>{t.paging&&r(i(t.paging))},[(t.paging||{size:0,number:0,length:0}).size,(t.paging||{size:0,number:0,length:0}).number,(t.paging||{size:0,number:0,length:0}).length]);let{number:l,size:s,sizes:u}=o,d=[],c=!0;for(let p=n.start;p<=n.end;p++)if(p<1||p>n.pages)d.push(_jsx("button",{className:"aio-input-table-paging-button aio-input-table-paging-button-hidden",children:p},p));else{let g;c?(g=1,c=!1):g=p===Math.min(n.end,n.pages)?n.pages:p,d.push(_jsx("button",{className:"aio-input-table-paging-button"+(g===l?" active":""),onClick:()=>a({number:g}),children:g},g))}function f(){if(!u||!u.length)return null;let e={attrs:{className:"aio-input-table-paging-button aio-input-table-paging-size"},type:"select",value:s,options:u,option:{text:"option",value:"option"},onChange:e=>a({size:e}),popover:{fitHorizontal:!0}};return _jsx(AIOInput,Object.assign({},e))}return _jsxs("div",{className:"aio-input-table-paging",children:[d,f()]})}function TableRows(){let{ROWS:e,rootProps:t}=useContext(AITableContext),{rowTemplate:n,rowAfter:i=()=>null,rowBefore:o=()=>null,rowsTemplate:r,placeholder:a="there is not any items"}=t,l=e.pagedRows||[],s;if(r)s=r(l);else if(l.length)s=l.map((e,t)=>{let{id:r="ailr"+Math.round(1e7*Math.random())}=e;e._id=void 0===e._id?r:e._id;let a=t===l.length-1,s;return s=n?n({row:e,rowIndex:t,isLast:a}):_jsx(TableRow,{row:e,rowIndex:t,isLast:a},e._id),_jsxs(Fragment,{children:[o({row:e,rowIndex:t}),s,i({row:e,rowIndex:t})]},e._id)});else{if(!a)return null;s=_jsx("div",{style:{width:"100%",textAlign:"center",padding:12,boxSizing:"border-box"},children:a})}return _jsx("div",{className:"aio-input-table-rows",children:s})}function TableToolbar(){let{add:e,exportToExcel:t,sorts:n,sortRows:i,setSorts:o,search:r,rootProps:a,excelColumns:l}=useContext(AITableContext),{toolbarAttrs:s,toolbar:u,onAdd:d,onSearch:c,onChangeSort:p,onChange:g=()=>{},value:f,addText:h}=a;if(s=UT.AddToAttrs(s,{className:"aio-input-table-toolbar"}),!d&&!u&&!c&&!n.length&&!l.length)return null;function m(e,t){v(n.map(n=>n.sortId===e?Object.assign(Object.assign({},n),t):n))}function v(e){return __awaiter(this,void 0,void 0,function*(){if(p)!1!==(yield p(e))&&o(e);else{o(e);let t=e.filter(e=>!1!==e.active);t.length&&g(i(f,t))}})}function $(){if(!n.length)return null;let e={popover:{header:{title:"Sort",onClose:!1},setAttrs(e){if("header"===e)return{className:"aio-input-table-toolbar-popover-header"}},limitTo:".aio-input-table"},caret:!1,type:"select",options:n,option:{text:"option.title",checked:"!!option.active",close:()=>!1,value:"option.sortId",after(e){let{dir:t="dec",sortId:n}=e;return _jsx("div",{onClick(e){e.stopPropagation(),m(n,{dir:"dec"===t?"inc":"dec"})},children:I("dec"===t?"mdiArrowDown":"mdiArrowUp",.8)})}},attrs:{className:"aio-input-table-toolbar-button"},text:I("mdiSort",.7),onSwap:(e,t,n)=>v(e),onChange:(e,t)=>m(e,{active:!t.checked})};return _createElement(AIOInput,Object.assign({},e,{key:"sortbutton"}))}function y(){let{addText:e}=a;return a.addText?"function"==typeof e?e(f):e:I("mdiPlusThick",.8)}return _jsxs(_Fragment,{children:[_jsxs("div",Object.assign({},s,{children:[u&&_jsx("div",{className:"aio-input-table-toolbar-content",children:"function"==typeof u?u():u}),_jsx("div",{className:"aio-input-table-search",children:!!c&&_jsx(AIOInput,{type:"text",onChange:e=>r(e),after:I("mdiMagnify",.7)})}),$(),!!l.length&&_jsx("div",{className:"aio-input-table-toolbar-button",onClick:()=>t(),children:I("mdiFileExcel",.8)}),!!d&&_jsx("div",{className:"aio-input-table-toolbar-button",onClick:()=>e(),children:y()})]})),_jsx(TableGap,{dir:"h"})]})}function TableHeader(){let{rootProps:e,columns:t}=useContext(AITableContext),{headerAttrs:n,onRemove:i}=e;n=UT.AddToAttrs(n,{className:"aio-input-table-header"});let o=t.map((e,n)=>_jsx(TableTitle,{column:e,isLast:n===t.length-1},e._id)),r=i?_jsxs(_Fragment,{children:[_jsx(TableGap,{dir:"v"}),_jsx("div",{className:"aio-input-table-remove-title"})]}):null;return _jsxs("div",Object.assign({},n,{children:[o,r,_jsx(TableGap,{dir:"h"})]}))}function TableTitle(e){let{column:t,isLast:n}=e,{getCellAttrs:i}=useContext(AITableContext),o=i({column:t,type:"title"});return _jsxs(_Fragment,{children:[_jsx("div",Object.assign({},o,{children:o.title})),!n&&_jsx(TableGap,{dir:"v"})]})}function TableRow(e){let{row:t,isLast:n,rowIndex:i}=e,{remove:o,rootProps:r,columns:a,getRowAttrs:l}=useContext(AITableContext);function s(){return a.map((e,n)=>{let o=t._id+" "+e._id;return _jsx(TableCell,{isLast:n===a.length-1,row:t,rowIndex:i,column:e},o)})}let{onRemove:u}=r;return _jsxs(_Fragment,{children:[_jsxs("div",Object.assign({},l(t,i),{children:[s(),u?_jsxs(_Fragment,{children:[_jsx(TableGap,{dir:"v"}),_jsx("button",{className:"aio-input-table-remove",onClick:()=>o(t,i),children:I("mdiClose",.8)})]}):null]}),t._id),_jsx(TableGap,{dir:"h"})]})}let TableCell=p=>{let{row,rowIndex,column,isLast}=p,{getCellAttrs,rootProps,getDynamics}=useContext(AITableContext),{onChange=()=>{},value=[]}=rootProps;function setCell(row,column,cellNewValue){column.input&&column.input.onChange?column.input.onChange({value:cellNewValue,row,column}):(row=JSON.parse(JSON.stringify(row)),eval(`${column.value} = cellNewValue`),onChange(value.map(e=>e._id!==row._id?e:row)))}let contentProps={row,rowIndex,column,onChange:column.input?e=>setCell(row,column,e):void 0},key=row._id+" "+column._id;return _jsxs(Fragment,{children:[_jsx("div",Object.assign({},getCellAttrs({row,rowIndex,column,type:"cell"}),{children:_createElement(TableCellContent,Object.assign({},contentProps,{key:key}))})),!isLast&&_jsx(TableGap,{dir:"v"})]},key)};function TableCellContent(e){let{row:t,column:n,rowIndex:i,onChange:o}=e,{getDynamics:r}=useContext(AITableContext),a=r({value:n.template,row:t,rowIndex:i,column:n});if(void 0!==a)return a;let l=r({value:n.input,row:t,rowIndex:i,column:n}),s=r({value:n.value,row:t,rowIndex:i,column:n});if(!l)return s;l.justify=l.justify||r({value:n.justify,row:t,rowIndex:i,column:n});let u={type:"text"};for(let d in l){let c=d,p=l[c];-1!==["onChange","onClick"].indexOf(c)?u[c]=p:u[c]=r({value:p,row:t,rowIndex:i,column:n})}return _createElement(AIOInput,Object.assign({},Object.assign(Object.assign({},u),{value:s,onChange:o,type:l.type}),{key:t._id+" "+n._id}))}function AIOInputSearch(e,t,n){if(!t)return e;function i(e,t){for(let n=0;n<e.length;n++)if(-1===t.indexOf(e[n]))return!1;return!0}let o=t.split(" ");return e.filter((e,t)=>i(o,n?n(e,t):e))}let RangeContext=createContext({}),Range=()=>{let{rootProps:e}=useContext(AICTX),t=useRef(e);t.current=e;let{start:n=0,end:i=360,min:o=n,max:r=i,step:a=1,reverse:l,round:s,vertical:u,multiple:d,text:c,onChange:p,size:g=Def("range-size"),disabled:f,className:h,labels:m=[],rotate:v=0}=e,[y]=useState({dom:createRef(),start:0,index:!1});function _(e){Array.isArray(e)||(e=[e||0]);for(let t=0;t<e.length;t++){let i=e[t]||0;(i=+(i=Math.round((i-n)/a)*a+n).toFixed(UT.GetPrecisionCount(a)))<o&&(i=o),i>r&&(i=r),e[t]=i}return e}let x=_(e.value),b=useRef(x);b.current=x;let[C,A]=useState(w());function w(){if(!Array.isArray(f))return{};let e={};for(let t=0;t<f.length;t++)e["a"+f[t]]=!0;return e}function N(e){return"point"===e?s?100:0:"label"===e?s?116:14:"scale"===e?s?100:14:0}function k(e){p&&(e=_(e),p(d?e:e[0]))}function T(e){if(!0===f||!1!==y.index)return;let t=b.current,n;(!((n=s?q(e.centerAngle):J(e[u?"yp":"xp"]))<t[t.length-1])||!(n>t[0]))&&(n<t[0]?L(-1):L(1))}function D(e){for(let t=0;t<e.length;t++)if(j(e[t]))return!1;return!0}useEffect(()=>{A(w())},[JSON.stringify(f)]),useEffect(()=>{p&&(clearTimeout(y.timeOut),y.timeOut=setTimeout(()=>{new UT.Swip({reverseX:!!l,reverseY:!!l&&!!u,dom:()=>$(y.dom.current),start(e){let{disabled:n}=t.current;if(!0===n)return!1;let{event:i}=e;if(null!==i.target){let o=$(i.target);if(UT.HasClass(o,"ai-range-point")){let r=o.attr("data-index")||"0";y.index=+r}else y.index=!1;y.start=[...b.current]}return[0,0]},move(e){let{change:t,mousePosition:n}=e;t&&S({dx:t.dx,dy:t.dy,deltaCenterAngle:t.deltaCenterAngle,centerAngle:n.centerAngle})},onClick:function(e){let{disabled:n}=t.current;!n&&T(e.mousePosition)}})},100))},[S]);let O=(e,t={})=>{let{half:n=!1,range:i=g/(n?2:1)}=t,o=i*e/100,{min:r,max:a}=t;return void 0!==r&&o<r&&(o=r),void 0!==a&&o>a&&(o=a),o},P=(e,t)=>{let n=e.thickness||1,i=0,o=e.roundCap||!1,r=e.full||!1,a=e.offset,l=e.color||"#000",s=e.className;try{let u=n;isNaN(u)&&(u=1),n=u;let d=a;isNaN(d)&&(d=0);let c=g/2-n/2;(i="offset"===t?c-d:d)>c&&(i=c),i<n/2?i=n/2:o=!1}catch(p){}return{thickness:n,radius:i,color:l,roundCap:o,full:r,className:s}},R=e=>{let{thickness:t=1,offset:n=0,color:i="#000",roundCap:o=!1,className:r}=e;try{let a=t;isNaN(a)&&(a=1),t=a;let l=n;isNaN(l)&&(l=0);(n=g/2-t/2-l)>g-t/2&&(n=g-t/2),n<t/2&&(n=t/2)}catch(s){}return{thickness:t,offset:n,color:i,roundCap:o,className:r}};function L(e){let t=[...b.current],n=JSON.stringify(t);for(t=G(t,e*a);!D(t)&&JSON.stringify(t)!==n;)n=JSON.stringify(t),t=G(t,e*a);k(t)}function S(e){if(!0===f)return;let t=z(e);k(t)}function M(e){let t=b.current,o,r;return o=0===e?n:t[e-1],r=e===t.length-1?i:t[e+1],{before:o,after:r}}function G(e,t,o){let r=e.map(e=>e+t);return r[0]<n||r[r.length-1]>i?o?b.current:e:r}function z(e){let{dx:t,dy:o,deltaCenterAngle:r,centerAngle:l}=e,d=[...y.start],c=y.index;1===d.length&&!1===c&&(c=0);let p;if(!1===c){let g;if(s){let f=r*(i-n)/360;g=f=Math.round(f/a)*a}else g=Math.round(J(Z(u?o:t))/a)*a;let h=G(d,g,!0);p=D(h)?h:b.current}else{let{before:m,after:v}=M(c),_;if(s)_=Math.round(q(l)/a)*a;else{let x=Math.round(J(Z(u?o:t))/a)*a;_=d[c]+x}_>v&&(_=v),_<m&&(_=m),j(_)&&(_=b.current[c]),d[c]=_,p=d}return p}function H(){return u?l?"bottom":"top":l?"right":"left"}function F(){return u?"left":"top"}function j(e){return!!C[`a${e}`]}function V(){let e="ai-range";return s?e+=" ai-range-round":e+=` ai-range-${u?"vertical":"horizontal"}`,h&&(e+=" "+h),l&&(e+=" ai-range-reverse"),e}function B(){let{style:t}=e,n;return Object.assign(Object.assign({},n=s?{width:g,height:g}:u?{width:g}:{height:g}),t)}function E(){let{attrs:t={}}=e,n=B();return UT.AddToAttrs(t,{className:V(),style:n,attrs:{ref:y.dom}})}function X(){return _jsxs("div",Object.assign({},E(),{children:[_jsx(RangeGroove,{}),void 0!==c&&_jsx("div",{className:"ai-range-text",children:"function"==typeof c?c():c},"rangetext"),!s&&_jsxs(Fragment,{children:[_jsx(RangeRanges,{}),_jsx(RangeFills,{})]},"rangefill"),_jsx(RangeSvg,{}),m.map((e,t)=>_jsx(RangeLabel,{label:e},t)),x.map((e,t)=>_jsx(RangeValueContainer,{index:t,itemValue:e},"rangecontainervalue"+t))]}))}function Y(e){let t=s=s||1,o=(1-t)*(i-n)/t;return e>i+o/2&&(e=n-o+e-i),e}function q(e){let t=360*(s||1),o=360-t;l&&(e=180-e),e-=v,e-=o/2,e-=90;let r=(e=U(e))*(i-n)/t;return Y(r)}function W(e,t){let o=360*s,r=360-o,a=e*o/(i-n);return a+=90,a+=r/2,a+=v,a+=t||0,l?a=180-a:a}function U(e){return(e%=360)<0?e=360+e:e}function K(e){return 100*(e-n)/(i-n)}function J(e){return e*(i-n)/100}function Z(e){return 100*e/$(y.dom.current)[u?"height":"width"]()}function Q(){return{getXPByValue:K,rootProps:e,fixAngle:U,getAngleByValue:W,dom:y.dom,getCircleByStr:P,getRectByStr:R,isValueDisabled:j,value:b.current,getSide:H,getOffset:F,getDefaultOffset:N,sbp:O}}return _jsx(RangeContext.Provider,{value:Q(),children:X()})},RangeGroove=()=>{let{rootProps:e}=useContext(RangeContext),t=UT.AddToAttrs(e.grooveAttrs,{className:"ai-range-groove"});return e.round?null:_jsx("div",Object.assign({},t))},RangeSvg=()=>{let{rootProps:e,value:t}=useContext(RangeContext),{round:n,ranges:i=[],circles:o=[],size:r=Def("range-size"),end:a=360}=e;if(!n||!(i||[0]).length&&!o.length)return null;let l=[_jsx(RangeCircles,{}),_jsx(RangeRanges,{})];return _jsx("svg",{style:{position:"absolute",left:0,top:0},width:r,height:r,children:l})},RangeCircles=()=>{let{rootProps:e,getCircleByStr:t}=useContext(RangeContext),{start:n=0,end:i=360,circles:o=[],size:r=Def("range-size")}=e,a=[];for(let l=0;l<o.length;l++){let s=n,u=i,{thickness:d,color:c,radius:p,roundCap:g,full:f}=t(o[l],"radius"),h={thickness:d,color:c,from:s,to:u,radius:p,full:f,roundCap:g};a.push(_jsx(RangeArc,Object.assign({},h),"rangecirclearc"+l))}return _jsx(_Fragment,{children:a})},RangeFills=()=>{let{rootProps:e,value:t}=useContext(RangeContext),{start:n=0,fill:i,round:o}=e;if(o||!1===i)return null;let r=1===t.length?[n,t[0]]:[...t],a=[];for(let l=1;l<r.length;l++){let{thickness:s,style:u,className:d,color:c}=("function"==typeof i?i(l):i)||{},p=r[l-1],g=r[l],f="ai-range-fill";d&&(f+=" "+d);let h={thickness:s,color:c,from:p,to:g,className:f,style:u};a.push(_createElement(RangeRect,Object.assign({},h,{key:"fill"+l})))}return _jsx(_Fragment,{children:a})},RangeRanges=()=>{let{rootProps:e,getCircleByStr:t,getRectByStr:n}=useContext(RangeContext),{start:i=0,ranges:o=[],round:r,end:a}=e,l=[],s=i,u=o;for(let d=0;d<u.length;d++){let[c,p]=u[d],g=s===i,f=s+c,h=f===a,m;if(r){let{thickness:v,color:$,radius:y,roundCap:_,className:x}=t(p,"offset");m=_jsx(RangeArc,Object.assign({},{thickness:v,color:$,from:s,to:f,radius:y,roundCap:_,full:!1,className:x}),"rangearc"+d)}else{let{thickness:b,color:C,offset:A,roundCap:w,className:N}=n(p),k=UT.classListToString(["ai-range-range",N,g?"ai-range-range-first":"",h?"ai-range-range-last":""]);m=_createElement(RangeRect,Object.assign({},{thickness:b,color:C,from:s,to:f,offset:A,roundCap:w,className:k},{key:"range"+d}))}l.push(m),s=f}return _jsx(_Fragment,{children:l})},RangeValueContainer=e=>{let{rootProps:t,isValueDisabled:n,fixAngle:i,getAngleByValue:o,getXPByValue:r,dom:a,getSide:l}=useContext(RangeContext),{itemValue:s,index:u}=e,{round:d}=t,c=i(o(s));function p(){let e;return e=d?{transform:`rotate(${c}deg)`}:{[l()]:r(s)+"%"},{className:"ai-range-value-container",draggable:!1,style:e}}let g={value:s,index:u,disabled:n(s),angle:c,parentDom:a};return _jsxs("div",Object.assign({},p(),{children:[_createElement(RangeHandle,Object.assign({},g,{key:"handle"}))," ",_createElement(RangePoint,Object.assign({},g,{key:"point"}))]}))},RangeRect=({thickness:e,color:t,from:n,to:i,className:o,style:r,offset:a,roundCap:l})=>{let{getXPByValue:s,rootProps:u,getSide:d}=useContext(RangeContext),{vertical:c}=u,p=s(n),g={[c?"height":"width"]:s(i)-p+"%"},f={[c?"width":"height"]:e},h={[d()]:p+"%"},m=a?{[c?"left":"top"]:a}:{},v=l?{borderRadius:"100%"}:{},$={background:t};return _jsx("div",{className:o,style:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g),f),h),m),v),$),r)})},RangeArc=({thickness:e,color:t,from:n,to:i,radius:o,full:r,roundCap:a,className:l})=>{let{fixAngle:s,getAngleByValue:u,rootProps:d}=useContext(RangeContext),{size:c=Def("range-size"),reverse:p}=d,g,f,h=c/2,m=c/2;if(r)g=0,f=360;else{let v=s(u(n)+90),$=s(u(i)+90);0===$&&($=360),g=v,f=$,p&&(f=v,g=$)}return _jsx("path",{d:UT.svgArc(h,m,o,g,f),stroke:t,strokeWidth:e,fill:"transparent",strokeLinecap:a?"round":void 0,className:l},`from${n}to${i}`)},RangePoint=e=>{let{rootProps:t,getOffset:n,sbp:i}=useContext(RangeContext),[o]=useState({dom:createRef()}),{value:r,disabled:a,angle:l,index:s,parentDom:u}=e;if(!1===t.point)return null;let{round:d,size:c=Def("range-size")}=t,{attrs:p={},html:g=r,offset:f=0}=(t.point||(()=>{}))({disabled:a,angle:l,value:r,index:s})||{},h,m=Object.assign({},p.style);h=d?{left:c/2+f,transform:`rotate(${-l}deg)`}:{[n()]:f};let v={ref:o.dom,className:"ai-range-point-container",style:h,draggable:!1},y=UT.AddToAttrs(p,{className:["ai-range-point"],style:m,attrs:{draggable:!1,"data-index":s}});return y.onMouseDown=e=>{let t=$(u.current).find("ai-range-value-container");t.css({zIndex:10}),t.eq(s).css({zIndex:100}),p.onMouseDown&&p.onMouseDown(e)},_createElement("div",Object.assign({},v,{key:"rangepoint"+s}),_jsx("div",Object.assign({},y,{children:g})))},RangeHandle=e=>{let{rootProps:t,sbp:n}=useContext(RangeContext),{value:i,angle:o,disabled:r,index:a}=e,{handle:l=()=>{},round:s}=t;if(!1===l||!s)return null;if(l&&"function"!=typeof l)return alert(`aio-input error => in type round, handle props should be a function,
        handle type = (value:number,{disabled:boolean,angle:number})=>{attrs:any}`),null;let{sharp:u=!1,thickness:d=10,size:c=90,color:p="#000",offset:g=0}=l(i,{angle:o,disabled:r,value:i})||{},f=n(c,{half:!0}),h=n(d,{half:!0});function m(){return u?{[f<0?"borderRight":"borderLeft"]:`${Math.abs(f)}px solid ${p}`,borderTop:`${h/2}px solid transparent`,borderBottom:`${h/2}px solid transparent`,left:g}:{width:f,height:h,left:g,background:p}}return _createElement("div",Object.assign({},UT.AddToAttrs({},{className:"aio-input-handle",style:m(),attrs:{draggable:!1}}),{key:"rangehandle"+a}))},RangeLabel=e=>{let{dom:t,rootProps:n}=useContext(RangeContext),{label:i}=e,{zIndex:o,dynamic:r,step:a,list:l=[]}=i,{round:s,start:u=0,end:d=360,reverse:c,vertical:p}=n,[g]=useState(f);function f(){return v(!0)}function h(){let e=[];if(a){let{start:t=u,end:n=d}=i;for(let o=t;o<=n;o+=a)e.push(o)}for(let r=0;r<l.length;r++)-1===e.indexOf(l[r])&&e.push(l[r]);return e}function m(){if(s||!i.autoHide||p)return;let e=$(t.current).find(".ai-range-label");if(!e.length)return;let n=e.eq(0),o="yes"===n.attr("data-rotated")?"height":"width",r=n.offset().left+(c?0:n[o]());for(let a=1;a<e.length;a++){let l=e.eq(a),u="yes"===l.attr("data-rotated")?"height":"width";l.css({display:"flex"});let d=l.offset().left,g=l[u](),f=d+g;c?f>r-5?l.css({display:"none"}):r=d:d<r+5?l.css({display:"none"}):r=d+g}}function v(e){return e||r?_jsx("div",{className:"ai-range-labels",style:{zIndex:o},children:h().map(e=>_jsx(RangeLabelItem,{label:i,itemValue:e},e))}):g}return useEffect(()=>{$(window).on("resize",m)},[]),useEffect(()=>{m()}),_jsx(_Fragment,{children:v(!1)})},RangeLabelItem=e=>{let{rootProps:t,isValueDisabled:n,fixAngle:i,getAngleByValue:o,getXPByValue:r,getSide:a}=useContext(RangeContext),{label:l,itemValue:s}=e,{round:u,vertical:d,size:c=Def("range-size")}=t,p;u&&(p=i(o(s)));let g=n(s);function f(e){return u?{transform:`rotate(${p}deg)`}:Object.assign({[a()]:r(s)+"%"},e)}function h(e,t){let n={};return u&&(n=Object.assign(Object.assign({},n),t),e.fixAngle&&(n=Object.assign(Object.assign({},n),{transform:`rotate(${-p}deg)`}))),Object.assign({width:0,height:0},n)}function m(){let e=l.setting(s,{disabled:g,angle:p}),{offset:t=0,html:n=""}=e,i={[u||d?"left":"top"]:c/2+t},o={className:"ai-range-label-container",style:f(i),draggable:!1},r=UT.AddToAttrs({},{className:["ai-range-label"],style:h(e,i),attrs:{draggable:!1}});return{html:n,textProps:r,containerProps:o}}let{html:v,textProps:$,containerProps:y}=m();return _jsx("div",Object.assign({},y,{children:_jsx("div",Object.assign({},$,{children:v}))}))};export const AISwitch=({colors:e=[],width:t=24,padding:n=1,value:i=!1,borderSize:o=2,buttonSize:r=12,onChange:a=()=>{},grooveSize:l=0,html:s=()=>null,attrs:u})=>{function d(){return{paddingRight:r+n,paddingLeft:n,border:`${o}px solid${e[0]&&e[1]?` ${i?e[1]:e[0]}`:""}`}}function c(){return{width:t-r-n,height:r+2*n}}function p(){return{width:r,height:r,top:`calc(50% - ${r/2}px)`,background:i?e[1]:e[0]}}function g(){return{position:"absolute",top:`calc(50% - ${l/2}px)`,width:`calc(100% - ${r+2*n}px)`,background:"#ddd",left:n+r/2,height:l}}let f=UT.AddToAttrs(u,{className:["aio-input-switch",i?"aio-input-main-color":void 0,i?"active":"deactive"],style:d(),attrs:{onClick:()=>a(!i)}}),h=UT.AddToAttrs({},{className:["aio-input-switch-inner",i?"aio-input-main-bg":void 0,i?"active":"deactive"],style:p()});return _jsxs("div",Object.assign({},f,{children:[!!l&&_jsx("div",{className:"aio-input-switch-groove",style:g()}),_jsx("div",{className:"aio-input-switch-outer",style:c(),children:_jsx("div",Object.assign({},h,{children:s(!!i)}))})]}))};export function AIOInput_defaultProps(e){let t=new UT.Storage("aio-input-storage");for(let n in e)t.save(n,e[n])}function getTypes(e){function t(){return -1!==["select","date","time"].indexOf(n)||-1!==["text","number","textarea"].indexOf(n)&&!!e.options||"button"===n&&!!e.popover}let{type:n,multiple:i}=e,o;return o="table"===n||"tags"===n||-1!==["radio","range","file","buttons","select","date","acardion"].indexOf(n)&&!!i,{isMultiple:o,isInput:-1!==["text","number","textarea","password"].indexOf(n),isDropdown:t(),hasOption:-1!==["text","number","textarea","color","select","radio","tabs","list","buttons","tags"].indexOf(n),hasPlaceholder:-1!==["text","number","textarea","color","select","table","image","date"].indexOf(n),hasKeyboard:-1!==["text","textarea","number","password"].indexOf(n),hasText:-1!==["checkbox","button","select"].indexOf(n),hasSearch:-1!==["table","select"].indexOf(n)}}function getDefaultProps(e,t){let n=Array.isArray(e.value)?"array":typeof e.value;return"select"===(e=Object.assign({},e)).type?e.multiple&&void 0===e.text&&(e.text="Select Items"):"time"===e.type?e.value||(e.value={}):"acardion"===e.type?e.deSelect=!0:"date"===e.type&&e.multiple&&(e.option=Object.assign(Object.assign({},e.option),{text:"option",value:"option"})),!0===e.loading&&(e.disabled=!0),t.isMultiple?e.value?"array"!==n&&(e.value=[e.value]):e.value=[]:"tree"===e.type||"array"===n&&(e.value=e.value[0]),e}function Def(e){return({theme:[],"date-size":180,"tree-size":36,"range-size":72,"date-unit":"day"})[e]}function I(e,t,n){return new GetSvg().getIcon(e,t,n)}function GetOptions(e){let{options:t,rootProps:n,types:i,level:o,isOpen:r,change:a,optionProp:l}=e,{deSelect:s}=n,u=[],d={},c=i.isDropdown&&i.hasOption&&!!n.onSwap;function p(e){return"select"===n.type&&i.isMultiple?-1!==n.value.indexOf(e):"radio"===n.type?i.isMultiple?-1!==n.value.indexOf(e):n.value===e:void 0}function g(e){return i.isMultiple?-1!==n.value.indexOf(e):e===n.value}s&&"function"!=typeof s&&!0!==s&&(t=[s,...t]);for(let f=0;f<t.length;f++){let h=t[f],m={index:f,active:!1,level:o,rootProps:n,change:a?e=>{a&&a(h,e)}:void 0},v=!!n.disabled||!!n.loading||!!GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"disabled"}),$=GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"show"});if(!1===$)continue;let y=GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"value"}),_=g(y),x=GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"text"});m.active=_;let b=GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"attrs",def:{}}),C=p(y),A=GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"checked",def:C}),w={optionOrg:h,show:$,loading:n.loading,attrs:b,text:x,value:y,disabled:v,draggable:c,checked:A,before:GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"before"}),after:GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"after"}),justify:GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"justify"}),subtext:GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"subtext"}),onClick:GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"onClick",preventFunction:!0}),className:GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"className"}),style:GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"style"}),tagAttrs:GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"tagAttrs"}),tagBefore:GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"tagBefore"}),close:GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"close",def:!i.isMultiple}),tagAfter:GetOptionProps({optionProp:l,optionOrg:h,optionDetails:m,key:"tagAfter"}),details:m};u.push(w),d["a"+w.value]=w}return{optionsList:u,optionsDic:d}}function GetOptionProps(p){let{optionProp,key,def,preventFunction,optionDetails,optionOrg}=p,optionResult="function"!=typeof optionOrg[key]||preventFunction?optionOrg[key]:optionOrg[key](optionOrg,optionDetails);if(void 0!==optionResult)return optionResult;let prop=optionProp[key];if("string"==typeof prop)try{let option=optionOrg,value;return eval("value = "+prop),value}catch(_a){}if("function"==typeof prop){if(preventFunction)return()=>prop(optionOrg,optionDetails);{let res=prop(optionOrg,optionDetails);return void 0===res?def:res}}return void 0!==prop?prop:def}function getTimeByUnit(e,t){let{value:n={},jalali:i,unit:o={year:!0,month:!0,day:!0}}=e;function r(){let e=new AIODate().getToday(i);return{year:e[0],month:e[1],day:e[2],hour:e[3],minute:e[4],second:e[5]}}let a=r(),l={},s;for(s in o)if(!0===o[s]){let u=n[s],d={year:1e3,month:1,day:1,hour:0,minute:0,second:0}[s],c={year:3e3,month:12,day:31,hour:23,minute:59,second:59}[s];(void 0!==u&&"number"!=typeof u||u<d||u>c)&&alert(`aio input error => in type time value.${s} should be an number between ${d} and ${c}`);let p=void 0===u||t?a[s]:u,g=e.timeStep&&e.timeStep[s]?e.timeStep[s]:void 0;g&&(p=Math.round(p/g)*g),l[s]=p}return l}function getTimeText(e){let t=getTimeByUnit(e);if(!t)return"string"==typeof e.placeholder?e.placeholder:"string"==typeof e.text?e.text:"";if(e.pattern)return new AIODate().getDateByPattern(t,e.pattern);if(void 0!==e.text)return e.text;let n=[],i=[];void 0!==t.year&&i.push(UT.Get2Digit(t.year)),void 0!==t.month&&i.push(UT.Get2Digit(t.month)),void 0!==t.day&&i.push(UT.Get2Digit(t.day)),i.length&&n.push(i.join("/"));let o=[];return void 0!==t.hour&&o.push(UT.Get2Digit(t.hour)),void 0!==t.minute&&o.push(UT.Get2Digit(t.minute)),void 0!==t.second&&o.push(UT.Get2Digit(t.second)),o.length&&n.push(o.join(":")),n.join(" ")}export const MonthCalendar=({date:e,onClick:t=()=>{},dateAttrs:n=()=>({})})=>{let i=new AIODate,[o]=useState(i.isJalali(e)),[r]=useState(i.getMonths(o)),[a]=useState(i.getWeekDay([e[0],e[1],1]).index),[l]=useState(i.getMonthDaysLength(e));function s(){return i.getWeekDays(!0).map(e=>_jsx("div",{className:"month-calendar-weekday",children:e[0]}))}function u(){return Array(a).fill(0).map(()=>_jsx("div",{className:""}))}function d(){return Array(l).fill(0).map((t,n)=>c([e[0],e[1],n+1]))}function c(e){let i=UT.AddToAttrs(n(e),{className:"month-calendar-day",attrs:{onClick:()=>t(e)}});return _jsx("div",Object.assign({},i,{children:e[2]}))}return _jsxs("div",{className:"month-calendar",children:[_jsx("div",{className:"month-calendar-title",children:r[e[1]-1]}),_jsx("div",{className:"month-calendar-weekdays",children:s()}),_jsxs("div",{className:"month-calendar-days",children:[u()," ",d()]})]})};export const Mask=e=>{let[t]=useState(createRef()),[n,i]=useState(e.value||""),[o,r]=useState(l(e.value||"")),a=useRef(o);function l(t){let n=[],i=t;for(let o of e.pattern)if("number"===o[0]||"text"===o[0]||"select"===o[0]){let r=+o[1],a=i.slice(0,r);n.push(a),i=i.slice(r,i.length)}else i=i.slice(o[1],i.length);return n}function s(n,o,a){let l=-1;console.log(n);let s="";for(let u=0;u<e.pattern.length;u++){let d=e.pattern[u];if("number"===d[0]||"text"===d[0]||"select"===d[0]){l++;let c=+d[1],p=n[l],g=c-p.length;if(g){let f="number"===d[0]?"0":"x";for(let h=0;h<g;h++)p=f+p;n[l]=p}else if(a===u){let m=$(t.current).find(".aio-input"),v=m.length;++o>v&&(o=0);let y=m.eq(o).find("input");y.length&&y.focus().select()}s+=p}else s+=d[0]}i(s),e.onChange(s),r(n)}function u(e,t,n){s(a.current.map((n,i)=>t===i?e:n),t,n)}function d(){let t=0;return e.pattern.map((e,n)=>{let i=e[0],o=t;if("text"===i||"number"===i){let r=+e[1];return t++,_jsx(AIText,{style:{width:10*r},placeholder:Array(r).fill("x").join(""),maxLength:r,filter:"number"===i?["number"]:void 0,value:a.current[o],onChange:e=>u(e,o,n)})}if("select"!==i)return _jsx("div",{className:"aio-input-mask-gap",children:e[2]||e[0]});{let l=e[2];return t++,_jsx(AISelect,{style:{width:"fit-content"},options:l,option:{text:"option",value:"option"},value:a.current[o],onChange:e=>u(e,o,n)})}})}return a.current=o,useEffect(()=>{i(e.value||""),r(l(e.value||""))},[e.value]),_jsx("div",{className:"example",children:_jsx("div",{className:"aio-input-mask",ref:t,title:n,children:d()})})};export const RichText=()=>{let e=usePopup(),t=useRef([]),n={tag:"div",items:[{tag:"h1",html:"this is my h1"},{tag:"ul",items:[{tag:"li",html:"item1"},{tag:"li",html:"item2"}]}]};function i(e){$(".rich-text-item").removeClass("rich-text-item-hover");let n=$(e.target);n.addClass("rich-text-item-hover");let i=n.attr("data-index"),o=i?i.split("-"):[];t.current=o.map(e=>+e)}function o(e,t){let n=e.tag,r=void 0!==e.html?e.html:(e.items||[]).map((e,n)=>o(e,[...t,n])),l=UT.AddToAttrs(e.attrs,{className:"rich-text-item",attrs:{"data-index":t.join("-")}});return _jsx(n,Object.assign({},l,{onMouseOver:e=>i(e),onClick(e){a(t)},children:r}))}function r(){let e=n;for(let i=0;i<t.current.length;i++){let o=t.current[i];e=e.items[o]}return e}function a(n){if(n.toString()!==t.current.toString())return;let i=r();e.addModal({position:"center",body:_jsxs("div",{className:"rich-text-options",children:[_jsx("div",{className:"rich-text-option-title",children:i.tag}),_jsx("div",{className:"rich-text-option",children:"Add Child"}),_jsx("div",{className:"rich-text-option",children:"Remove"}),_jsx("div",{className:"rich-text-option",children:"Move Up"}),_jsx("div",{className:"rich-text-option",children:"Move Down"})]})})}return _jsxs("div",{className:"msf",children:[_jsx("div",{className:"msf"}),_jsx("div",{className:"msf",children:o(n,[])}),_jsx(RichModal,{item:n}),e.render()]})};let RichModal=e=>{let[t,n]=useState(e.item);return _jsxs("div",{className:"rich-text-options",children:[_jsx("div",{className:"rich-text-option-title",children:t.tag}),_jsx(AIButtons,{justify:!0,style:{border:"1px solid #ddd"},options:[{text:"none",value:void 0},{text:"v",value:"align-v-"},{text:"h",value:"align-h-"},{text:"vh",value:"align-vh-"}],option:{text:"none"},value:t.align,onChange:e=>n(Object.assign(Object.assign({},t),{align:e}))})]})};export const JoyStick=e=>{let{scale:t=1}=e,[n,i]=useState();if(useEffect(()=>{let{x:t,y:n,angle:o,length:r}=e;if(void 0!==t&&void 0!==n&&i({x:t,y:n}),void 0!==o&&void 0!==r){let{left:a,top:l}=UT.getLeftAndTopByCenterAngleLength([e.size/2,e.size/2],o,r);i({x:a,y:l})}},[]),!n)return null;function o(n){let{x:i,y:o,length:r,angle:a}=n;i/=t,o/=t,r/=t,e.onChange({x:i,y:o,length:r,angle:a})}return _jsx(JOYSTICK,{x:n.x*t,y:n.y*t,size:e.size,onChange:o,centerOriented:e.centerOriented})};let JOYSTICK=({size:e,x:t,y:n,onChange:i,centerOriented:o})=>{let[r]=useState([e/2,e/2]),[a,l]=useState([r[0]+t,r[0]+n]),s=useRef(a);s.current=a;let[u]=useState(createRef());function d(){return s.current}function c(){o&&(i({x:0,y:0,length:0,angle:0}),l(r))}function p(e){let{x:t,y:n,centerAngle:o,centerDistance:a}=e.mousePosition;l([t,n]),t-=r[0],n-=r[1],i({x:t,y:n,length:a,angle:o})}return useEffect(()=>{new UT.Swip({dom:()=>$(u.current),start:d,move:p,end:c,maxCenterDistance:e/2})},[]),_jsx("div",{style:{width:e,height:e},className:"joy-stick",ref:u,children:_jsx("div",{style:{left:s.current[0],top:s.current[1]},className:"joy-stick-button",children:_jsx("div",{})})})};export const AIText=e=>_jsx(AIOInput,Object.assign({},e,{type:"text"}));export const AINumber=e=>_jsx(AIOInput,Object.assign({},e,{type:"number"}));export const AITextarea=e=>_jsx(AIOInput,Object.assign({},e,{type:"textarea"}));export const AIPassword=e=>_jsx(AIOInput,Object.assign({},e,{type:"password"}));export const AIColor=e=>_jsx(AIOInput,Object.assign({},e,{type:"color"}));export const AISelect=e=>_jsx(AIOInput,Object.assign({},e,{type:"select"}));export const AIRadio=e=>_jsx(AIOInput,Object.assign({},e,{type:"radio"}));export const AITabs=e=>_jsx(AIOInput,Object.assign({},e,{type:"tabs"}));export const AIButtons=e=>_jsx(AIOInput,Object.assign({},e,{type:"buttons"}));export const AITags=e=>_jsx(AIOInput,Object.assign({},e,{type:"tags"}));export const AITree=e=>_jsx(AIOInput,Object.assign({},e,{type:"tree"}));export const AIImage=e=>_jsx(AIOInput,Object.assign({},e,{type:"image"}));export const AIFile=e=>_jsx(AIOInput,Object.assign({},e,{type:"file"}));export const AICheckbox=e=>_jsx(AIOInput,Object.assign({},e,{type:"checkbox"}));export const AIDate=e=>_jsx(AIOInput,Object.assign({},e,{type:"date"}));export const AITime=e=>_jsx(AIOInput,Object.assign({},e,{type:"time"}));export const AISlider=e=>_jsx(AIOInput,Object.assign({},e,{type:"slider"}));export const AISpinner=e=>_jsx(AIOInput,Object.assign({},e,{type:"spinner"}));export const AIAcardion=e=>_jsx(AIOInput,Object.assign({},e,{type:"acardion"}));export const AIList=e=>_jsx(AIOInput,Object.assign({},e,{type:"list"}));export const AITable=e=>_jsx(AIOInput,Object.assign({},e,{type:"table"}));export const useForm=e=>{function t(){return JSON.parse(JSON.stringify(e.initData))}function n(t){return!!(e.isRequired||(()=>!1))($.current,t)}let[i]=useState(t),o=useRef(void 0),r=useRef({}),a=useInput(),l=useError({getData:p,rootProps:e,isRequired:n}),s=useNode(),u=e=>!!r.current[e],[d,c]=useState(t);function p(){return $.current}let g=t=>{$.current=t,c(t),e.onChange&&e.onChange(t)},f=()=>{if(!o.current)return!1;let e=new Date().getTime()-o.current;return e<2e3},h=()=>{if(!e.onSubmit){console.error("you are using useForm submit method but missing set onSubmit in useForm definition");return}!f()&&(o.current=new Date().getTime(),e.onSubmit(p()))},m=(e,t)=>{let n=Object.assign({},$.current);r.current=Object.assign(Object.assign({},r.current),{[e.field]:!0}),l.getErrorByInput(e,t),UT.setValueByField(n,e.field,t),g(n)};function v(e,t){let n=a.get(e);n&&m(n,t)}let $=useRef(d);function y(e){let{field:t}=e,n;return void 0!==e.value?e.value:UT.getValueByField($.current,t)}$.current=d;let _=()=>{let e=t();$.current=e,l.resetErrors(),g(e)},x=()=>JSON.stringify(i)!==JSON.stringify($.current),b=()=>({rootProps:e,getData:p,isDataChanged:x,isFieldChanged:u,getValueByInput:y,changeData:g,changeByInput:m,reset:_,nodeHook:s,errorHook:l,isSubmitDisabled:A,inputHook:a,isRequired:n}),C=()=>{if(!e.getLayout)return null;let t=b(),n=e.getLayout(t);return _jsx(AIFormNode,{node:n,context:t,level:0,index:0})},A=()=>{if(!x())return e.debug&&console.log("submit disabled due not data changed"),!0;let t=l.getErrorsList();return t.length?(e.debug&&console.log("submit disabled due there is error :",t),!0):!!f()&&(e.debug&&console.log("submit disabled due timer"),!0)},w=(e,t)=>_jsx(AIFormInputContainer,{context:b(),input:e,attrs:s.getAttrs({node:{input:e,attrs:t},isRoot:!1})}),N=C();return{data:d,changeData:g,renderLayout:_jsx(_Fragment,{children:N}),reset:_,submit:h,errors:l,isSubmitDisabled:A,renderInput:w,changeByField:v}};let useError=e=>{let{fa:t}=e.rootProps,n=useRef({}),i=(e,t)=>n.current=Object.assign(Object.assign({},n.current),{[e]:t});function o(n,o){let{label:r,validateType:a,field:l}=n,s=e.isRequired(l),u=void 0===o||""===o||null===o,d;return u?d=s?t?`${r} ضروری است`:`${r} is required`:void 0:("email"!==a||UT.IsValidEmail(o)||(d=t?`فرمت ${r} صحیح نیست`:`${r} format is incorrect`),"irNationalCode"!==a||UT.IsValidIrNationalCode(o)||(d=t?`فرمت ${r} صحیح نیست`:`${r} format is incorrect`),"irMobile"===a&&(d=UT.ValidateIrMobile({value:o,label:"string"==typeof r?r:"",fa:t}))),n.validate&&(d=n.validate({data:e.getData(),value:o,input:n,field:n.field})),("undefined"===o||"[Object-Object]"===o||"null"===o||"NaN"===o)&&(d=t?"این مقدار مجاز نیست":"this value is forbidden"),i(l,d),d}let r=()=>{let e=n.current,t=Object.keys(e),i=t.filter(t=>!!e[t]);return i.map(t=>e[t])},a=()=>!!r().length,l=()=>n.current={};return{setErrorByField:i,hasError:a,getErrorByInput:o,getErrorsList:r,resetErrors:l}},useInput=()=>{let e=useRef({}),t=(t,n)=>e.current=Object.assign(Object.assign({},e.current),{[t]:n});function n(t){return e.current[t]}return{set:t,get:n}},useNode=()=>{let e=(e,t)=>{let n={flex:e.flex};return t&&(t.h||t.v)&&(n[t.v?"height":"width"]=e.size),Object.assign(Object.assign({},n),e.style)};function t(e){let t,n,i,o,r=[];return e.show_xs&&(t=!1,n=!0,i=!0,o=!0),e.hide_xs&&(t=!0),e.show_sm&&(t=!0,n=!1,i=!0,o=!0),e.hide_sm&&(n=!0),e.show_md&&(t=!0,n=!0,i=!1,o=!0),e.hide_md&&(i=!0),e.show_lg&&(t=!0,n=!0,i=!0,o=!1),e.hide_lg&&(o=!0),t&&r.push("ai-form-hide-xs"),n&&r.push("ai-form-hide-sm"),i&&r.push("ai-form-hide-md"),o&&r.push("ai-form-hide-lg"),r}let n=(e,n,i)=>{let o,r,a=i?"ai-form":void 0,l=t(e);return e.v?(o="ai-form-scroll-v","v"===e.align?r="ai-form-justify-center":"h"===e.align?r="ai-form-items-center":"vh"===e.align?r="ai-form-justify-center ai-form-items-center":"hv"===e.align&&(r="ai-form-justify-center ai-form-items-center")):e.h?(o="ai-form-scroll-h","v"===e.align?r="ai-form-items-center":"h"===e.align?r="ai-form-justify-center":"vh"===e.align?r="ai-form-justify-center ai-form-items-center":"hv"===e.align&&(r="ai-form-justify-center ai-form-items-center")):e.html&&("v"===e.align?r="ai-form-items-center":"h"===e.align?r="ai-form-justify-center":"vh"===e.align?r="ai-form-justify-center ai-form-items-center":"hv"===e.align&&(r="ai-form-justify-center ai-form-items-center")),[a,n,e.className,o,r,...l]},i=t=>{let{node:i,parentNode:o,isRoot:r}=t,a="";return i.v||i.h?a=`ai-form-${i.v?"v":"h"}`:i.html&&(a="ai-form-html"),UT.AddToAttrs(i.attrs,{className:n(i,a,r),style:e(i,o)})};return{getAttrs:i}},AIFormNode=({node:e,context:t,level:n,index:i,parentNode:o})=>{let[r,a]=useState(null),{show:l=!0,isStatic:s}=e,u=()=>{if(!l)return null;if(Array.isArray(e.h)||Array.isArray(e.v))return _jsx(AIFormGroup,{node:e,context:t,level:n,index:i,parentNode:o});let{nodeHook:r}=t;if(void 0!==e.html){let a=r.getAttrs({node:e,isRoot:0===n,parentNode:o});return _jsx("div",Object.assign({},a,{children:e.html}))}if(e.input){let s=Object.assign(Object.assign({},r.getAttrs({node:e,isRoot:!1})),{"data-label":e.input.label});return _jsx(AIFormInputContainer,{attrs:s,input:e.input,context:t,size:e.size},e.input.field)}};return useEffect(()=>{s&&a(u())},[s]),s?_jsx(_Fragment,{children:r}):_jsx(_Fragment,{children:u()})},AIFormGroup=({node:e,context:t,level:n,parentNode:i})=>{let{tag:o="div",legend:r}=e,{nodeHook:a}=t,l=_jsxs(_Fragment,{children:[!!r&&"fieldset"===o&&_jsx("legend",{children:r}),e[e.v?"v":"h"].map((i,o)=>_jsx(AIFormNode,{node:i,parentNode:e,context:t,level:n+1,index:o},`level-${n+1}-index-${o}`))]}),s=a.getAttrs({node:e,isRoot:0===n,parentNode:i});return 0===n?_jsx("form",Object.assign({},s,{children:l})):"section"===o?_jsx("section",Object.assign({},s,{children:l})):"fieldset"===o?_jsx("fieldset",Object.assign({},s,{children:l})):"p"===o||"form"===o?_jsx("p",Object.assign({},s,{children:l})):_jsx("div",Object.assign({},s,{children:l}))},AIFormInputContainer=({context:e,input:t,attrs:n,size:i})=>{let{getValueByInput:o,errorHook:r,changeByInput:a,inputHook:l,rootProps:s}=e,{inputAttrs:u,field:d}=t;l.set(d,t);let c=o(t),p=r.getErrorByInput(t,c);return _jsx(RenderInput,{value:c,error:p,input:t,context:e,size:i,inlineLabel:s.inlineLabel,inputProps:Object.assign(Object.assign({},t),{inputAttrs:Object.assign(Object.assign({},u),{"aria-label":d}),value:c,onChange(e,n){t.onChange?t.onChange(e,n):a(t,e)}}),attrs:n})},RenderInput=e=>{let{context:t,attrs:n,input:i,inputProps:o,error:r,size:a,inlineLabel:l}=e,{isFieldChanged:s,rootProps:u,isRequired:d}=t,[c,p]=useState(null);return useEffect(()=>{"width"===i.label&&(console.log("rerender input"),console.log("inputProps",o));let{field:e,label:t}=i,c=d(e);p(_jsx(AIFormInput,{required:c,labelAttrs:u.labelAttrs,inlineLabel:l,input:_jsx(AIOInput,Object.assign({},o,{type:o.type,className:"ai-form-aio-input"})),label:t,error:s(e)?r:void 0,attrs:Object.assign(Object.assign({},n),{style:Object.assign({width:a||void 0},n.style)})}))},[JSON.stringify(o,(e,t)=>isValidElement(t)?void 0:t),r]),_jsx(Fragment,{children:c},i.field)};export const AIFormInput=e=>{let{label:t,input:n,error:i,attrs:o,id:r,required:a=!0,labelAttrs:l,className:s,style:u,inlineLabel:d}=e,c=UT.AddToAttrs(o,{className:["ai-form-input",s,d?"ai-form-input-inline-label":void 0],style:u}),p=UT.AddToAttrs(l,{className:"ai-form-input-label",attrs:{htmlFor:r}});return _jsxs("div",Object.assign({},c,{children:[!!t&&_jsxs("label",Object.assign({},p,{children:[a?_jsx("div",{className:"ai-form-required",children:"*"}):null,t]})),_jsxs("div",{className:"ai-form-input-body",children:[!!e.before&&_jsx("div",{className:"ai-form-input-body-before"}),_jsx("div",{className:"ai-form-input-body-input","data-subtext":e.subtext?e.subtext:void 0,children:n}),!!e.after&&_jsx("div",{className:"ai-form-input-body-after"})]}),!!i&&_jsx("div",{className:"ai-form-input-error",children:i})]}))};export const Plate=({type:e,value:t,onChange:n,label:i})=>{let o=(e,i)=>{let o=[];for(let r=0;r<4;r++)i===r?o.push(e):o.push(t[r]||"");n(o)};return _jsxs("div",{className:"aio-input-plate",children:[!!i&&_jsx("div",{className:"aio-input-plate-label",children:i}),"car"===e&&_jsxs(_Fragment,{children:[_jsx("div",{className:"aio-input-plate-item",children:_jsx(AIText,{maxLength:2,filter:["number"],value:t[0],onChange:e=>o(e,0)})}),_jsx("div",{className:"aio-input-plate-item",children:_jsx(AISelect,{options:["الف","ب","ت","ج","ح","د","ر","ز","ژ","س","ص","ط","ع","ف","ق","ک","گ","ل","م","ن","و","ه"],option:{text:"option",value:"option"},value:t[1],onChange:e=>o(e,1)})}),_jsx("div",{className:"aio-input-plate-item",children:_jsx(AIText,{maxLength:3,filter:["number"],value:t[2],onChange:e=>o(e,2)})}),_jsx("div",{className:"aio-input-plate-item",children:_jsx(AIText,{maxLength:2,filter:["number"],value:t[3],onChange:e=>o(e,3)})})]})]})};